#MICROBIOME ANALYSES

#1 ANALYSES OF EACH GIT SECTION LUMINAL CONTENTS FOR EACH TRIAL.

#TRIAL 1 DUODENUM

set.seed(3711)
library(dplyr)
library(tidyr)
library(stringr)
library(xlsx)
options(scipen=1000)
testbiome = read.table("D:/HAUPT1_Updated/Duodenum/stability.opti_mcc1.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT1_Updated/Duodenum/stability.cons1.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Duodenum/Seqs.xlsx", sheetName = "Seqs Duodenum", append = FALSE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
write.table(testbiome, file = "D:/HAUPT1_Updated/Duodenum/Relative Abundance Duodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Duodenum/Relative Abundance Duodenum.xlsx", sheetName = "RA Duodenum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT1_Updated/Duodenum/PhylumDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT1_Updated/Duodenum/PhylumDuodenum.xlsx", sheetName = "PhylumDuodenum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT1_Updated/Duodenum/GenusDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT1_Updated/Duodenum/GenusDuodenum.xlsx", sheetName = "GenusDuodenum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Duodenum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Duodenum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumDuodenum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT1_Updated/Duodenum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT1_Updated/Duodenum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusDuodenum", append = FALSE)

#TRIAL 1 JEJUNUM

testbiome = read.table("D:/HAUPT1_Updated/Jejunum/stability.opti_mcc2.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT1_Updated/Jejunum/stability.cons2.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT1_Updated/Jejunum/Results")
write.table(testbiome, file = "D:/HAUPT1_Updated/Jejunum/Results/Relative Abundance Jejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Jejunum/Results/Relative Abundance Jejunum.xlsx", sheetName = "RA Jejunum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT1_Updated/Jejunum/Results/PhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT1_Updated/Jejunum/Results/PhylumJejunum.xlsx", sheetName = "PhylumJejunum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT1_Updated/Jejunum/Results/GenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT1_Updated/Jejunum/Results/GenusJejunum.xlsx", sheetName = "GenusJejunum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Jejunum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Jejunum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT1_Updated/Jejunum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT1_Updated/Jejunum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)

#TRIAL 1 ILEUM

testbiome = read.table("D:/HAUPT1_Updated/Ileum/stability.opti_mcc3.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT1_Updated/Ileum/stability.cons3.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT1_Updated/Ileum/Results")
write.table(testbiome, file = "D:/HAUPT1_Updated/Ileum/Results/Relative Abundance Ileum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Ileum/Results/Relative Abundance Ileum.xlsx", sheetName = "RA Ileum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT1_Updated/Ileum/Results/PhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT1_Updated/Ileum/Results/PhylumIleum.xlsx", sheetName = "PhylumIleum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT1_Updated/Ileum/Results/GenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT1_Updated/Ileum/Results/GenusIleum.xlsx", sheetName = "GenusIleum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT1_Updated/Ileum/Results/TotalPhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT1_Updated/Ileum/Results/TotalPhylumIleum.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT1_Updated/Ileum/Results/TotalGenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT1_Updated/Ileum/Results/TotalGenusIleum.xlsx", sheetName = "TotalGenusIleum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Ileum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Ileum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT1_Updated/Ileum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT1_Updated/Ileum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusIleum", append = FALSE)

#TRIAL 1 CAECUM

testbiome = read.table("D:/HAUPT1_Updated/Caecum/stability.opti_mcc4.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT1_Updated/Caecum/stability.cons4.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT1_Updated/Caecum/Results")
write.table(testbiome, file = "D:/HAUPT1_Updated/Caecum/Results/Relative Abundance Caecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Caecum/Results/Relative Abundance Caecum.xlsx", sheetName = "RA Caecum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT1_Updated/Caecum/Results/PhylumCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT1_Updated/Caecum/Results/PhylumCaecum.xlsx", sheetName = "PhylumCaecum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT1_Updated/Caecum/Results/GenusCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT1_Updated/Caecum/Results/GenusCaecum.xlsx", sheetName = "GenusCaecum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Caecum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Caecum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumCaecum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT1_Updated/Caecum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT1_Updated/Caecum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusCaecum", append = FALSE)

#TRIAL 1 COLON

testbiome = read.table("D:/HAUPT1_Updated/Colon/stability.opti_mcc5.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT1_Updated/Colon/stability.cons5.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT1_Updated/Colon/Results")
write.table(testbiome, file = "D:/HAUPT1_Updated/Colon/Results/Relative Abundance Colon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Colon/Results/Relative Abundance Colon.xlsx", sheetName = "RA Colon", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT1_Updated/Colon/Results/PhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT1_Updated/Colon/Results/PhylumColon.xlsx", sheetName = "PhylumColon", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT1_Updated/Colon/Results/GenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT1_Updated/Colon/Results/GenusColon.xlsx", sheetName = "GenusColon", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT1_Updated/Colon/Results/TotalPhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT1_Updated/Colon/Results/TotalPhylumColon.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT1_Updated/Colon/Results/TotalGenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT1_Updated/Colon/Results/TotalGenusColon.xlsx", sheetName = "TotalGenusColon", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Colon/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Colon/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT1_Updated/Colon/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT1_Updated/Colon/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusColon", append = FALSE)

TRIAL 1 RECTUM

testbiome = read.table("D:/HAUPT1_Updated/Rectum/stability.opti_mcc6.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT1_Updated/Rectum/stability.cons6.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT1_Updated/Rectum/Results")
write.table(testbiome, file = "D:/HAUPT1_Updated/Rectum/Results/Relative Abundance Rectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT1_Updated/Rectum/Results/Relative Abundance Rectum.xlsx", sheetName = "RA Rectum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT1_Updated/Rectum/Results/PhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT1_Updated/Rectum/Results/PhylumRectum.xlsx", sheetName = "PhylumRectum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT1_Updated/Rectum/Results/GenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT1_Updated/Rectum/Results/GenusRectum.xlsx", sheetName = "GenusRectum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Rectum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT1_Updated/Rectum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumRectum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT1_Updated/Rectum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT1_Updated/Rectum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusRectum", append = FALSE)


#TRIAL 2 DUODENUM

testbiome = read.table("D:/HAUPT2_Updated/Duodenum/stability.opti_mcc7.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(10, 11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT2_Updated/Duodenum/stability.cons7.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 9)
testbiome <- testbiome[ -c(18)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16,17)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:20], colPerc)
testbiome[, 9:20] <- sapply(testbiome[, 9:20], colPerc)
dir.create("D:/HAUPT2_Updated/Duodenum/Results")
write.table(testbiome, file = "D:/HAUPT2_Updated/Duodenum/Results/Relative Abundance Duodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT2_Updated/Duodenum/Results/Relative Abundance Duodenum.xlsx", sheetName = "RA Duodenum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT2_Updated/Duodenum/Results/PhylumDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT2_Updated/Duodenum/Results/PhylumDuodenum.xlsx", sheetName = "PhylumDuodenum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT2_Updated/Duodenum/Results/GenusDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT2_Updated/Duodenum/Results/GenusDuodenum.xlsx", sheetName = "GenusDuodenum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Duodenum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Duodenum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumDuodenum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Duodenum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Duodenum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusDuodenum", append = FALSE)

#TRIAL 2 JEJUNUM

testbiome = read.table("D:/HAUPT2_Updated/Jejunum/stability.opti_mcc8.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(10, 11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT2_Updated/Jejunum/stability.cons8.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 9)
testbiome <- testbiome[ -c(18)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16,17)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:20], colPerc)
testbiome[, 9:20] <- sapply(testbiome[, 9:20], colPerc)
dir.create("D:/HAUPT2_Updated/Jejunum/Results")
write.table(testbiome, file = "D:/HAUPT2_Updated/Jejunum/Results/Relative Abundance Jejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT2_Updated/Jejunum/Results/Relative Abundance Jejunum.xlsx", sheetName = "RA Jejunum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT2_Updated/Jejunum/Results/PhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT2_Updated/Jejunum/Results/PhylumJejunum.xlsx", sheetName = "PhylumJejunum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT2_Updated/Jejunum/Results/GenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT2_Updated/Jejunum/Results/GenusJejunum.xlsx", sheetName = "GenusJejunum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalPhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalPhylumJejunum.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalGenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalGenusJejunum.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Jejunum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)

#TRIAL 2 ILEUM

testbiome = read.table("D:/HAUPT2_Updated/Ileum/stability.opti_mcc9.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(10, 11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT2_Updated/Ileum/stability.cons9.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 9)
testbiome <- testbiome[ -c(18)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16,17)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:20], colPerc)
testbiome[, 9:20] <- sapply(testbiome[, 9:20], colPerc)
dir.create("D:/HAUPT2_Updated/Ileum/Results")
write.table(testbiome, file = "D:/HAUPT2_Updated/Ileum/Results/Relative Abundance Ileum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT2_Updated/Ileum/Results/Relative Abundance Ileum.xlsx", sheetName = "RA Ileum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT2_Updated/Ileum/Results/PhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT2_Updated/Ileum/Results/PhylumIleum.xlsx", sheetName = "PhylumIleum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT2_Updated/Ileum/Results/GenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT2_Updated/Ileum/Results/GenusIleum.xlsx", sheetName = "GenusIleum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Ileum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Ileum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Ileum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Ileum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusIleum", append = FALSE)


#TRIAL 2 CAECUM

testbiome = read.table("D:/HAUPT2_Updated/Caecum/stability.opti_mcc10.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(10, 11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT2_Updated/Caecum/stability.cons10.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 9)
testbiome <- testbiome[ -c(18)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16,17)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:20], colPerc)
testbiome[, 9:20] <- sapply(testbiome[, 9:20], colPerc)
dir.create("D:/HAUPT2_Updated/Caecum/Results")
write.table(testbiome, file = "D:/HAUPT2_Updated/Caecum/Results/Relative Abundance Caecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT2_Updated/Caecum/Results/Relative Abundance Caecum.xlsx", sheetName = "RA Caecum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT2_Updated/Caecum/Results/PhylumCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT2_Updated/Caecum/Results/PhylumCaecum.xlsx", sheetName = "PhylumCaecum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT2_Updated/Caecum/Results/GenusCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT2_Updated/Caecum/Results/GenusCaecum.xlsx", sheetName = "GenusCaecum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Caecum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Caecum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumCaecum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Caecum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Caecum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusCaecum", append = FALSE)


#TRIAL 2 COLON

testbiome = read.table("D:/HAUPT2_Updated/Colon/stability.opti_mcc11.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(10, 11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT2_Updated/Colon/stability.cons11.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 9)
testbiome <- testbiome[ -c(18)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16,17)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:20], colPerc)
testbiome[, 9:20] <- sapply(testbiome[, 9:20], colPerc)
dir.create("D:/HAUPT2_Updated/Colon/Results")
write.table(testbiome, file = "D:/HAUPT2_Updated/Colon/Results/Relative Abundance Colon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT2_Updated/Colon/Results/Relative Abundance Colon.xlsx", sheetName = "RA Colon", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT2_Updated/Colon/Results/PhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT2_Updated/Colon/Results/PhylumColon.xlsx", sheetName = "PhylumColon", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT2_Updated/Colon/Results/GenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT2_Updated/Colon/Results/GenusColon.xlsx", sheetName = "GenusColon", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT2_Updated/Colon/Results/TotalPhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT2_Updated/Colon/Results/TotalPhylumColon.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT2_Updated/Colon/Results/TotalGenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT2_Updated/Colon/Results/TotalGenusColon.xlsx", sheetName = "TotalGenusColon", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Colon/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Colon/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Colon/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Colon/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusColon", append = FALSE)


#TRIAL 2 RECTUM

testbiome = read.table("D:/HAUPT2_Updated/Rectum/stability.opti_mcc12.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(10, 11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT2_Updated/Rectum/stability.cons12.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 9)
testbiome <- testbiome[ -c(18)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16,17)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:20], colPerc)
testbiome[, 9:20] <- sapply(testbiome[, 9:20], colPerc)
dir.create("D:/HAUPT2_Updated/Rectum/Results")
write.table(testbiome, file = "D:/HAUPT2_Updated/Rectum/Results/Relative Abundance Rectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT2_Updated/Rectum/Results/Relative Abundance Rectum.xlsx", sheetName = "RA Rectum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT2_Updated/Rectum/Results/PhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT2_Updated/Rectum/Results/PhylumRectum.xlsx", sheetName = "PhylumRectum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT2_Updated/Rectum/Results/GenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT2_Updated/Rectum/Results/GenusRectum.xlsx", sheetName = "GenusRectum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT2_Updated/Rectum/Results/TotalPhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT2_Updated/Rectum/Results/TotalPhylumRectum.xlsx", sheetName = "TotalPhylumRectum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT2_Updated/Rectum/Results/TotalGenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT2_Updated/Rectum/Results/TotalGenusRectum.xlsx", sheetName = "TotalGenusRectum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT2_Updated/Rectum/Results/TotalPhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT2_Updated/Rectum/Results/TotalPhylumRectum.xlsx", sheetName = "TotalPhylumRectum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT2_Updated/Rectum/Results/TotalGenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT2_Updated/Rectum/Results/TotalGenusRectum.xlsx", sheetName = "TotalGenusRectum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Rectum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT2_Updated/Rectum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumRectum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT2_Updated/Rectum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT2_Updated/Rectum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusRectum", append = FALSE)

#TRIAL 3 DUODENUM

testbiome = read.table("D:/HAUPT3_Updated/Duodenum/stability.opti_mcc13.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT3_Updated/Duodenum/stability.cons13.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT3_Updated/Duodenum/Results")
write.table(testbiome, file = "D:/HAUPT3_Updated/Duodenum/Results/Relative Abundance Duodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT3_Updated/Duodenum/Results/Relative Abundance Duodenum.xlsx", sheetName = "RA Duodenum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT3_Updated/Duodenum/Results/PhylumDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT3_Updated/Duodenum/Results/PhylumDuodenum.xlsx", sheetName = "PhylumDuodenum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT3_Updated/Duodenum/Results/GenusDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT3_Updated/Duodenum/Results/GenusDuodenum.xlsx", sheetName = "GenusDuodenum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Duodenum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Duodenum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumDuodenum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT3_Updated/Duodenum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT3_Updated/Duodenum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusDuodenum", append = FALSE)

#TRIAL 3 JEJUNUM

testbiome = read.table("D:/HAUPT3_Updated/Jejunum/stability.opti_mcc14.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT3_Updated/Jejunum/stability.cons14.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT3_Updated/Jejunum/Results")
write.table(testbiome, file = "D:/HAUPT3_Updated/Jejunum/Results/Relative Abundance Jejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT3_Updated/Jejunum/Results/Relative Abundance Jejunum.xlsx", sheetName = "RA Jejunum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT3_Updated/Jejunum/Results/PhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT3_Updated/Jejunum/Results/PhylumJejunum.xlsx", sheetName = "PhylumJejunum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT3_Updated/Jejunum/Results/GenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT3_Updated/Jejunum/Results/GenusJejunum.xlsx", sheetName = "GenusJejunum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalPhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalPhylumJejunum.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalGenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalGenusJejunum.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT3_Updated/Jejunum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)

#TRIAL 3 ILEUM

testbiome = read.table("D:/HAUPT3_Updated/Ileum/stability.opti_mcc15.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT3_Updated/Ileum/stability.cons15.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT3_Updated/Ileum/Results")
write.table(testbiome, file = "D:/HAUPT3_Updated/Ileum/Results/Relative Abundance Ileum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT3_Updated/Ileum/Results/Relative Abundance Ileum.xlsx", sheetName = "RA Ileum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT3_Updated/Ileum/Results/PhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT3_Updated/Ileum/Results/PhylumIleum.xlsx", sheetName = "PhylumIleum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT3_Updated/Ileum/Results/GenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT3_Updated/Ileum/Results/GenusIleum.xlsx", sheetName = "GenusIleum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT3_Updated/Ileum/Results/TotalPhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT3_Updated/Ileum/Results/TotalPhylumIleum.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT3_Updated/Ileum/Results/TotalGenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT3_Updated/Ileum/Results/TotalGenusIleum.xlsx", sheetName = "TotalGenusIleum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Ileum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Ileum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT3_Updated/Ileum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT3_Updated/Ileum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusIleum", append = FALSE)

#TRIAL 3 CAECUM

testbiome = read.table("D:/HAUPT3_Updated/Caecum/stability.opti_mcc16.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT3_Updated/Caecum/stability.cons16.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT3_Updated/Caecum/Results")
write.table(testbiome, file = "D:/HAUPT3_Updated/Caecum/Results/Relative Abundance Caecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT3_Updated/Caecum/Results/Relative Abundance Caecum.xlsx", sheetName = "RA Caecum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT3_Updated/Caecum/Results/PhylumCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT3_Updated/Caecum/Results/PhylumCaecum.xlsx", sheetName = "PhylumCaecum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT3_Updated/Caecum/Results/GenusCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT3_Updated/Caecum/Results/GenusCaecum.xlsx", sheetName = "GenusCaecum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT3_Updated/Caecum/Results/TotalPhylumCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT3_Updated/Caecum/Results/TotalPhylumCaecum.xlsx", sheetName = "TotalPhylumCaecum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT3_Updated/Caecum/Results/TotalGenusCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT3_Updated/Caecum/Results/TotalGenusCaecum.xlsx", sheetName = "TotalGenusCaecum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Caecum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Caecum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumCaecum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT3_Updated/Caecum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT3_Updated/Caecum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusCaecum", append = FALSE)

#TRIAL 3 COLON

testbiome = read.table("D:/HAUPT3_Updated/Colon/stability.opti_mcc17.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT3_Updated/Colon/stability.cons17.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT3_Updated/Colon/Results")
write.table(testbiome, file = "D:/HAUPT3_Updated/Colon/Results/Relative Abundance Colon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT3_Updated/Colon/Results/Relative Abundance Colon.xlsx", sheetName = "RA Colon", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT3_Updated/Colon/Results/PhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT3_Updated/Colon/Results/PhylumColon.xlsx", sheetName = "PhylumColon", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT3_Updated/Colon/Results/GenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT3_Updated/Colon/Results/GenusColon.xlsx", sheetName = "GenusColon", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT3_Updated/Colon/Results/TotalPhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT3_Updated/Colon/Results/TotalPhylumColon.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT3_Updated/Colon/Results/TotalGenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT3_Updated/Colon/Results/TotalGenusColon.xlsx", sheetName = "TotalGenusColon", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Colon/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Colon/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT3_Updated/Colon/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT3_Updated/Colon/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusColon", append = FALSE)

#TRIAL 3 RECTUM

testbiome = read.table("D:/HAUPT3_Updated/Rectum/stability.opti_mcc18.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT3_Updated/Rectum/stability.cons18.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT3_Updated/Rectum/Results")
write.table(testbiome, file = "D:/HAUPT3_Updated/Rectum/Results/Relative Abundance Rectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT3_Updated/Rectum/Results/Relative Abundance Rectum.xlsx", sheetName = "RA Rectum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT3_Updated/Rectum/Results/PhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT3_Updated/Rectum/Results/PhylumRectum.xlsx", sheetName = "PhylumRectum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT3_Updated/Rectum/Results/GenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT3_Updated/Rectum/Results/GenusRectum.xlsx", sheetName = "GenusRectum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Rectum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT3_Updated/Rectum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumRectum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT3_Updated/Rectum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT3_Updated/Rectum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusRectum", append = FALSE)

#TRIAL 4 DUODENUM

testbiome = read.table("D:/HAUPT4_Updated/Duodenum/stability.opti_mcc19.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(9, 10),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT4_Updated/Duodenum/stability.cons19.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 8)
testbiome <- testbiome[ -c(17)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(13,14,15,16)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,16)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:19], colPerc)
testbiome[, 9:19] <- sapply(testbiome[, 9:19], colPerc)
dir.create("D:/HAUPT4_Updated/Duodenum/Results")
write.table(testbiome, file = "D:/HAUPT4_Updated/Duodenum/Results/Relative Abundance Duodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT4_Updated/Duodenum/Results/Relative Abundance Duodenum.xlsx", sheetName = "RA Duodenum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT4_Updated/Duodenum/Results/PhylumDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT4_Updated/Duodenum/Results/PhylumDuodenum.xlsx", sheetName = "PhylumDuodenum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT4_Updated/Duodenum/Results/GenusDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT4_Updated/Duodenum/Results/GenusDuodenum.xlsx", sheetName = "GenusDuodenum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalPhylumDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalPhylumDuodenum.xlsx", sheetName = "TotalPhylumDuodenum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalGenusDuodenum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalGenusDuodenum.xlsx", sheetName = "TotalGenusDuodenum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumDuodenum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT4_Updated/Duodenum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusDuodenum", append = FALSE)

#TRIAL 4 JEJUNUM

testbiome = read.table("D:/HAUPT4_Updated/Jejunum/stability.opti_mcc20.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT4_Updated/Jejunum/stability.cons20.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 10)
testbiome <- testbiome[ -c(19)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17,18)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,18)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:21], colPerc)
testbiome[, 9:21] <- sapply(testbiome[, 9:21], colPerc)
dir.create("D:/HAUPT4_Updated/Jejunum/Results")
write.table(testbiome, file = "D:/HAUPT4_Updated/Jejunum/Results/Relative Abundance Jejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT4_Updated/Jejunum/Results/Relative Abundance Jejunum.xlsx", sheetName = "RA Jejunum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT4_Updated/Jejunum/Results/PhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT4_Updated/Jejunum/Results/PhylumJejunum.xlsx", sheetName = "PhylumJejunum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT4_Updated/Jejunum/Results/GenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT4_Updated/Jejunum/Results/GenusJejunum.xlsx", sheetName = "GenusJejunum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalPhylumJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalPhylumJejunum.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalGenusJejunum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalGenusJejunum.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumJejunum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT4_Updated/Jejunum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusJejunum", append = FALSE)

#TRIAL 4 ILEUM

testbiome = read.table("D:/HAUPT4_Updated/Ileum/stability.opti_mcc21.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT4_Updated/Ileum/stability.cons21.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 10)
testbiome <- testbiome[ -c(19)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17,18)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,18)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:21], colPerc)
testbiome[, 9:21] <- sapply(testbiome[, 9:21], colPerc)
dir.create("D:/HAUPT4_Updated/Ileum/Results")
write.table(testbiome, file = "D:/HAUPT4_Updated/Ileum/Results/Relative Abundance Ileum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT4_Updated/Ileum/Results/Relative Abundance Ileum.xlsx", sheetName = "RA Ileum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT4_Updated/Ileum/Results/PhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT4_Updated/Ileum/Results/PhylumIleum.xlsx", sheetName = "PhylumIleum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT4_Updated/Ileum/Results/GenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT4_Updated/Ileum/Results/GenusIleum.xlsx", sheetName = "GenusIleum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT4_Updated/Ileum/Results/TotalPhylumIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT4_Updated/Ileum/Results/TotalPhylumIleum.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT4_Updated/Ileum/Results/TotalGenusIleum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT4_Updated/Ileum/Results/TotalGenusIleum.xlsx", sheetName = "TotalGenusIleum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Ileum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Ileum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumIleum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT4_Updated/Ileum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT4_Updated/Ileum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusIleum", append = FALSE)

#TRIAL 4 CAECUM

testbiome = read.table("D:/HAUPT4_Updated/Caecum/stability.opti_mcc22.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT4_Updated/Caecum/stability.cons22.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 10)
testbiome <- testbiome[ -c(19)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17,18)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,18)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:21], colPerc)
testbiome[, 9:21] <- sapply(testbiome[, 9:21], colPerc)
dir.create("D:/HAUPT4_Updated/Caecum/Results")
write.table(testbiome, file = "D:/HAUPT4_Updated/Caecum/Results/Relative Abundance Caecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT4_Updated/Caecum/Results/Relative Abundance Caecum.xlsx", sheetName = "RA Caecum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT4_Updated/Caecum/Results/PhylumCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT4_Updated/Caecum/Results/PhylumCaecum.xlsx", sheetName = "PhylumCaecum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT4_Updated/Caecum/Results/GenusCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT4_Updated/Caecum/Results/GenusCaecum.xlsx", sheetName = "GenusCaecum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT4_Updated/Caecum/Results/TotalPhylumCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT4_Updated/Caecum/Results/TotalPhylumCaecum.xlsx", sheetName = "TotalPhylumCaecum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT4_Updated/Caecum/Results/TotalGenusCaecum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT4_Updated/Caecum/Results/TotalGenusCaecum.xlsx", sheetName = "TotalGenusCaecum", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Caecum/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Caecum/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumCaecum", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT4_Updated/Caecum/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT4_Updated/Caecum/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusCaecum", append = FALSE)

#TRIAL 4 COLON

testbiome = read.table("D:/HAUPT4_Updated/Colon/stability.opti_mcc23.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT4_Updated/Colon/stability.cons23.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 10)
testbiome <- testbiome[ -c(19)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17,18)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,18)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:21], colPerc)
testbiome[, 9:21] <- sapply(testbiome[, 9:21], colPerc)
dir.create("D:/HAUPT4_Updated/Colon/Results")
write.table(testbiome, file = "D:/HAUPT4_Updated/Colon/Results/Relative Abundance Colon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT4_Updated/Colon/Results/Relative Abundance Colon.xlsx", sheetName = "RA Colon", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT4_Updated/Colon/Results/PhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT4_Updated/Colon/Results/PhylumColon.xlsx", sheetName = "PhylumColon", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT4_Updated/Colon/Results/GenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT4_Updated/Colon/Results/GenusColon.xlsx", sheetName = "GenusColon", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT4_Updated/Colon/Results/TotalPhylumColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT4_Updated/Colon/Results/TotalPhylumColon.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT4_Updated/Colon/Results/TotalGenusColon.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT4_Updated/Colon/Results/TotalGenusColon.xlsx", sheetName = "TotalGenusColon", append = FALSE)
TotalPhylumGraph <- select(testbiomePhylum, Phylum, CONTROL, GOS)
OtherPhylum <- TotalPhylumGraph[-c(1:10), ]
OtherPhylum <- OtherPhylum %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherPhylum <- OtherPhylum %>% slice_tail(n = 1)
TotalPhylumGraph <- TotalPhylumGraph %>% slice(1:10)
TotalPhylumGraph <- rbind(TotalPhylumGraph,OtherPhylum[1,])
write.table(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Colon/Results/TotalPhylumGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylumGraph, file = "D:/HAUPT4_Updated/Colon/Results/TotalPhylumGraph.xlsx", sheetName = "TotalPhylumColon", append = FALSE)
TotalGenusGraph <- select(testbiomeGenus, Genus, CONTROL, GOS)
OtherGenus <- TotalGenusGraph[-c(1:10), ]
OtherGenus <- OtherGenus %>%
  bind_rows(summarise(.,
                      across(where(is.numeric), sum),
                      across(where(is.character), ~"Others")))
OtherGenus <- OtherGenus %>% slice_tail(n = 1)
TotalGenusGraph <- TotalGenusGraph %>% slice(1:10)
TotalGenusGraph <- rbind(TotalGenusGraph,OtherGenus[1,])
write.table(TotalGenusGraph, file = "D:/HAUPT4_Updated/Colon/Results/TotalGenusGraph.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenusGraph, file = "D:/HAUPT4_Updated/Colon/Results/TotalGenusGraph.xlsx", sheetName = "TotalGenusColon", append = FALSE)

#TRIAL 4 RECTUM

testbiome = read.table("D:/HAUPT4_Updated/Rectum/stability.opti_mcc24.shared", header=TRUE, sep="\t")
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = testbiome[-c(11, 12),]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT4_Updated/Rectum/stability.cons24.taxonomy", header=TRUE, sep="\t")
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
testbiome$count <- rowSums(testbiome =="0")
testbiome = filter(testbiome, count < 10)
testbiome <- testbiome[ -c(19)]
testbiome$CONTROL <- rowSums(testbiome[ , c(9,10,11,12,13)],na.rm=TRUE)
testbiome$GOS <- rowSums(testbiome[ , c(14,15,16,17,18)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9,10,11,12,13,14,15,18)],na.rm=TRUE)
colPerc <- function(x){x / sum(x) * 100}
sapply(testbiome[, 9:21], colPerc)
testbiome[, 9:21] <- sapply(testbiome[, 9:21], colPerc)
dir.create("D:/HAUPT4_Updated/Rectum/Results")
write.table(testbiome, file = "D:/HAUPT4_Updated/Rectum/Results/Relative Abundance Rectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiome, file = "D:/HAUPT4_Updated/Rectum/Results/Relative Abundance Rectum.xlsx", sheetName = "RA Rectum", append = FALSE)
testbiomePhylum <- testbiome %>%
     group_by(Phylum) %>%
     summarise_if(is.numeric, sum)
testbiomePhylum <- testbiomePhylum[ -c(2)]
testbiomePhylum <- testbiomePhylum %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomePhylum, file = "D:/HAUPT4_Updated/Rectum/Results/PhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomePhylum, file = "D:/HAUPT4_Updated/Rectum/Results/PhylumRectum.xlsx", sheetName = "PhylumRectum", append = FALSE)
testbiomeGenus <- testbiome %>%
     group_by(Genus) %>%
     summarise_if(is.numeric, sum)
testbiomeGenus <- testbiomeGenus[ -c(2)]
testbiomeGenus <- testbiomeGenus %>%
     mutate(rank_order = min_rank(-TOTAL)) %>%
     arrange(rank_order)
write.table(testbiomeGenus, file = "D:/HAUPT4_Updated/Rectum/Results/GenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(testbiomeGenus, file = "D:/HAUPT4_Updated/Rectum/Results/GenusRectum.xlsx", sheetName = "GenusRectum", append = FALSE)
TotalPhylum <- select(testbiomePhylum, Phylum, CONTROL, GOS,TOTAL)
write.table(TotalPhylum, file = "D:/HAUPT4_Updated/Rectum/Results/TotalPhylumRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalPhylum, file = "D:/HAUPT4_Updated/Rectum/Results/TotalPhylumRectum.xlsx", sheetName = "TotalPhylumRectum", append = FALSE)
TotalGenus <- select(testbiomeGenus, Genus, CONTROL, GOS,TOTAL)
write.table(TotalGenus, file = "D:/HAUPT4_Updated/Rectum/Results/TotalGenusRectum.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
write.xlsx(TotalGenus, file = "D:/HAUPT4_Updated/Rectum/Results/TotalGenusRectum.xlsx", sheetName = "TotalGenusRectum", append = FALSE)

#FIGURE 1

#ANALYSES OF ALL TRIALS AND GIT SECTIONS FOR NUMBER OF OTUs.

set.seed(3711)
library(ggplot2)
library(ggvenn)
library(ggVennDiagram)
library(ggpubr)
library(dplyr)
library(tidyr)
library(stringr)
library(openxlsx)
options(scipen=1000)
testbiome = read.table("D:/HAUPT_ALL/Duodenum/duodenum.stability.opti_mcc.shared", header=TRUE, sep="\t")
View(testbiome)
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT_ALL/Duodenum/duodenum.stability.cons.taxonomy", header=TRUE, sep="\t")
View(testax)
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
View(testbiome)
testbiome$CONTROL <- rowSums(testbiome[ , c(9:26)],na.rm=TRUE)
testbiome$TEST <- rowSums(testbiome[ , c(26:43)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9:43)],na.rm=TRUE)
testbiome$Trial_1 <- rowSums(testbiome[ , c(9,19,20,21,27,36,37,38)],na.rm=TRUE)
testbiome$Trial_2 <- rowSums(testbiome[ , c(22,23,24,25,26,39,40,41,42)],na.rm=TRUE)
testbiome$Trial_3 <- rowSums(testbiome[ , c(10,11,12,13,43,28,29,30)],na.rm=TRUE)
testbiome$Trial_4 <- rowSums(testbiome[ , c(14,15,16,17,18,31,32,33,34,17)],na.rm=TRUE)
vennDuodenum = vennDuodenum <- select(testbiome, Trial_1, Trial_2, Trial_3, Trial_4)
write.table(vennDuodenum, file = "D:/HAUPT_ALL/Duodenum/vennDuodenumSequences.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
vennDuodenum$row_num <- seq.int(nrow(vennDuodenum))
vennDuodenum$Set1 <- ifelse(vennDuodenum$Trial_1 > 0, vennDuodenum$row_num, 0)
vennDuodenum$Set2 <- ifelse(vennDuodenum$Trial_2 > 0, vennDuodenum$row_num, 0)
vennDuodenum$Set3 <- ifelse(vennDuodenum$Trial_3 > 0, vennDuodenum$row_num, 0)
vennDuodenum$Set4 <- ifelse(vennDuodenum$Trial_4 > 0, vennDuodenum$row_num, 0)
vennDuodenum1 = vennDuodenum1 <- select(vennDuodenum, Set1, Set2, Set3, Set4)
write.table(vennDuodenum1, file = "D:/HAUPT_ALL/Duodenum/VennDuodenum1.txt", sep = "\t", row.names = FALSE, col.names = TRUE)

testbiome = read.table("D:/HAUPT_ALL/Jejunum/jejunum.stability.opti_mcc.shared", header=TRUE, sep="\t")
View(testbiome)
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT_ALL/Jejunum/jejunum.stability.cons.taxonomy", header=TRUE, sep="\t")
View(testax)
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
View(testbiome)
testbiome$CONTROL <- rowSums(testbiome[ , c(9:26)],na.rm=TRUE)
testbiome$TEST <- rowSums(testbiome[ , c(26:43)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9:43)],na.rm=TRUE)
testbiome$Trial_1 <- rowSums(testbiome[ , c(9,19,20,21,27,36,37,38)],na.rm=TRUE)
testbiome$Trial_2 <- rowSums(testbiome[ , c(22,23,24,25,26,39,40,41,42)],na.rm=TRUE)
testbiome$Trial_3 <- rowSums(testbiome[ , c(10,11,12,13,43,28,29,30)],na.rm=TRUE)
testbiome$Trial_4 <- rowSums(testbiome[ , c(14,15,16,17,18,31,32,33,34,17)],na.rm=TRUE)
vennJejunum = vennJejunum <- select(testbiome, Trial_1, Trial_2, Trial_3, Trial_4)
write.table(vennJejunum, file = "D:/HAUPT_ALL/Jejunum/vennJejunumSequences.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
vennJejunum$row_num <- seq.int(nrow(vennJejunum))
vennJejunum$Set1 <- ifelse(vennJejunum$Trial_1 > 0, vennJejunum$row_num, 0)
vennJejunum$Set2 <- ifelse(vennJejunum$Trial_2 > 0, vennJejunum$row_num, 0)
vennJejunum$Set3 <- ifelse(vennJejunum$Trial_3 > 0, vennJejunum$row_num, 0)
vennJejunum$Set4 <- ifelse(vennJejunum$Trial_4 > 0, vennJejunum$row_num, 0)
vennJejunum1 = vennJejunum1 <- select(vennJejunum, Set1, Set2, Set3, Set4)
write.table(vennJejunum1, file = "D:/HAUPT_ALL/Jejunum/VennJejunum1.txt", sep = "\t", row.names = FALSE, col.names = TRUE)

testbiome = read.table("D:/HAUPT_ALL/Ileum/ileum.stability.opti_mcc.shared", header=TRUE, sep="\t")
View(testbiome)
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT_ALL/Ileum/ileum.stability.cons.taxonomy", header=TRUE, sep="\t")
View(testax)
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
View(testbiome)
testbiome$CONTROL <- rowSums(testbiome[ , c(9:26)],na.rm=TRUE)
testbiome$TEST <- rowSums(testbiome[ , c(26:43)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9:43)],na.rm=TRUE)
testbiome$Trial_1 <- rowSums(testbiome[ , c(9,19,20,21,27,36,37,38)],na.rm=TRUE)
testbiome$Trial_2 <- rowSums(testbiome[ , c(22,23,24,25,26,39,40,41,42)],na.rm=TRUE)
testbiome$Trial_3 <- rowSums(testbiome[ , c(10,11,12,13,43,28,29,30)],na.rm=TRUE)
testbiome$Trial_4 <- rowSums(testbiome[ , c(14,15,16,17,18,31,32,33,34,17)],na.rm=TRUE)
vennIleum = vennIleum <- select(testbiome, Trial_1, Trial_2, Trial_3, Trial_4)
write.table(vennIleum, file = "D:/HAUPT_ALL/Ileum/vennIleumSequences.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
vennIleum$row_num <- seq.int(nrow(vennIleum))
vennIleum$Set1 <- ifelse(vennIleum$Trial_1 > 0, vennIleum$row_num, 0)
vennIleum$Set2 <- ifelse(vennIleum$Trial_2 > 0, vennIleum$row_num, 0)
vennIleum$Set3 <- ifelse(vennIleum$Trial_3 > 0, vennIleum$row_num, 0)
vennIleum$Set4 <- ifelse(vennIleum$Trial_4 > 0, vennIleum$row_num, 0)
vennIleum1 = vennIleum1 <- select(vennIleum, Set1, Set2, Set3, Set4)
write.table(vennIleum1, file = "D:/HAUPT_ALL/Ileum/VennIleum1.txt", sep = "\t", row.names = FALSE, col.names = TRUE)

testbiome = read.table("D:/HAUPT_ALL/Caecum/caecum.stability.opti_mcc.shared", header=TRUE, sep="\t")
View(testbiome)
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT_ALL/Caecum/caecum.stability.cons.taxonomy", header=TRUE, sep="\t")
View(testax)
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
View(testbiome)
testbiome$CONTROL <- rowSums(testbiome[ , c(9:26)],na.rm=TRUE)
testbiome$TEST <- rowSums(testbiome[ , c(26:43)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9:43)],na.rm=TRUE)
testbiome$Trial_1 <- rowSums(testbiome[ , c(9,19,20,21,27,36,37,38)],na.rm=TRUE)
testbiome$Trial_2 <- rowSums(testbiome[ , c(22,23,24,25,26,39,40,41,42)],na.rm=TRUE)
testbiome$Trial_3 <- rowSums(testbiome[ , c(10,11,12,13,43,28,29,30)],na.rm=TRUE)
testbiome$Trial_4 <- rowSums(testbiome[ , c(14,15,16,17,18,31,32,33,34,17)],na.rm=TRUE)
vennCaecum = vennCaecum <- select(testbiome, Trial_1, Trial_2, Trial_3, Trial_4)
write.table(vennCaecum, file = "D:/HAUPT_ALL/Caecum/vennCaecumSequences.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
vennCaecum$row_num <- seq.int(nrow(vennCaecum))
vennCaecum$Set1 <- ifelse(vennCaecum$Trial_1 > 0, vennCaecum$row_num, 0)
vennCaecum$Set2 <- ifelse(vennCaecum$Trial_2 > 0, vennCaecum$row_num, 0)
vennCaecum$Set3 <- ifelse(vennCaecum$Trial_3 > 0, vennCaecum$row_num, 0)
vennCaecum$Set4 <- ifelse(vennCaecum$Trial_4 > 0, vennCaecum$row_num, 0)
vennCaecum1 = vennCaecum1 <- select(vennCaecum, Set1, Set2, Set3, Set4)
write.table(vennCaecum1, file = "D:/HAUPT_ALL/Caecum/VennCaecum1.txt", sep = "\t", row.names = FALSE, col.names = TRUE)

testbiome = read.table("D:/HAUPT_ALL/Colon/colon.stability.opti_mcc.shared", header=TRUE, sep="\t")
View(testbiome)
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT_ALL/Colon/colon.stability.cons.taxonomy", header=TRUE, sep="\t")
View(testax)
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
View(testbiome)
testbiome$CONTROL <- rowSums(testbiome[ , c(9:26)],na.rm=TRUE)
testbiome$TEST <- rowSums(testbiome[ , c(26:43)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9:43)],na.rm=TRUE)
testbiome$Trial_1 <- rowSums(testbiome[ , c(9,19,20,21,27,36,37,38)],na.rm=TRUE)
testbiome$Trial_2 <- rowSums(testbiome[ , c(22,23,24,25,26,39,40,41,42)],na.rm=TRUE)
testbiome$Trial_3 <- rowSums(testbiome[ , c(10,11,12,13,43,28,29,30)],na.rm=TRUE)
testbiome$Trial_4 <- rowSums(testbiome[ , c(14,15,16,17,18,31,32,33,34,17)],na.rm=TRUE)
vennColon = vennColon <- select(testbiome, Trial_1, Trial_2, Trial_3, Trial_4)
write.table(vennColon, file = "D:/HAUPT_ALL/Colon/vennColonSequences.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
vennColon$row_num <- seq.int(nrow(vennColon))
vennColon$Set1 <- ifelse(vennColon$Trial_1 > 0, vennColon$row_num, 0)
vennColon$Set2 <- ifelse(vennColon$Trial_2 > 0, vennColon$row_num, 0)
vennColon$Set3 <- ifelse(vennColon$Trial_3 > 0, vennColon$row_num, 0)
vennColon$Set4 <- ifelse(vennColon$Trial_4 > 0, vennColon$row_num, 0)
vennColon1 = vennColon1 <- select(vennColon, Set1, Set2, Set3, Set4)
write.table(vennColon1, file = "D:/HAUPT_ALL/Colon/VennColon1.txt", sep = "\t", row.names = FALSE, col.names = TRUE)

testbiome = read.table("D:/HAUPT_ALL/Rectum/rectum.stability.opti_mcc.shared", header=TRUE, sep="\t")
View(testbiome)
row.names(testbiome) = testbiome$Group
testbiome = testbiome[,-which(names(testbiome) %in% c("label", "numOtus", "Group"))]
testbiome = t(testbiome)
testax = read.table("D:/HAUPT_ALL/Rectum/rectum.stability.cons.taxonomy", header=TRUE, sep="\t")
View(testax)
testax <- testax %>% mutate(Taxonomy = str_replace_all(Taxonomy, "\\s*\\([^\\)]+\\)", ""))
testax = separate(testax, Taxonomy, into = c("Kingdom", "Phylum", "Class", "Order", "Family", "Genus"), sep=";")
testbiome <-cbind(testax, testbiome)
View(testbiome)
testbiome$CONTROL <- rowSums(testbiome[ , c(9:26)],na.rm=TRUE)
testbiome$TEST <- rowSums(testbiome[ , c(26:43)],na.rm=TRUE)
testbiome$TOTAL <- rowSums(testbiome[ , c(9:43)],na.rm=TRUE)
testbiome$Trial_1 <- rowSums(testbiome[ , c(9,19,20,21,27,36,37,38)],na.rm=TRUE)
testbiome$Trial_2 <- rowSums(testbiome[ , c(22,23,24,25,26,39,40,41,42)],na.rm=TRUE)
testbiome$Trial_3 <- rowSums(testbiome[ , c(10,11,12,13,43,28,29,30)],na.rm=TRUE)
testbiome$Trial_4 <- rowSums(testbiome[ , c(14,15,16,17,18,31,32,33,34,17)],na.rm=TRUE)
vennRectum = vennRectum <- select(testbiome, Trial_1, Trial_2, Trial_3, Trial_4)
write.table(vennRectum, file = "D:/HAUPT_ALL/Rectum/vennRectumSequences.txt", sep = "\t", row.names = TRUE, col.names = TRUE)
vennRectum$row_num <- seq.int(nrow(vennRectum))
vennRectum$Set1 <- ifelse(vennRectum$Trial_1 > 0, vennRectum$row_num, 0)
vennRectum$Set2 <- ifelse(vennRectum$Trial_2 > 0, vennRectum$row_num, 0)
vennRectum$Set3 <- ifelse(vennRectum$Trial_3 > 0, vennRectum$row_num, 0)
vennRectum$Set4 <- ifelse(vennRectum$Trial_4 > 0, vennRectum$row_num, 0)
vennRectum1 = vennRectum1 <- select(vennRectum, Set1, Set2, Set3, Set4)
write.table(vennRectum1, file = "D:/HAUPT_ALL/Rectum/VennRectum1.txt", sep = "\t", row.names = FALSE, col.names = TRUE)

vennDuodenum = read.table("D:/HAUPT_ALL/Duodenum/VennDuodenum1.txt", header=TRUE, sep="\t")
Set1 <- vennDuodenum$Set1
Set2 <- vennDuodenum$Set2
Set3 <- vennDuodenum$Set3
Set4 <- vennDuodenum$Set4
vennDuodenum <-list("T1" = Set1, "T2" = Set2, "T3" = Set3, "T4" = Set4)
V1 <- ggvenn(vennDuodenum, show_percentage = FALSE,fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
        stroke_size = 0.5, set_name_size = 5) + labs(title = "Duodenum") + theme(plot.title=element_text(hjust=0.5))

vennJejunum = read.table("D:/HAUPT_ALL/Jejunum/VennJejunum1.txt", header=TRUE, sep="\t")
Set1 <- vennJejunum$Set1
Set2 <- vennJejunum$Set2
Set3 <- vennJejunum$Set3
Set4 <- vennJejunum$Set4
vennJejunum <-list("T1" = Set1, "T2" = Set2, "T3" = Set3, "T4" = Set4)
V2 <- ggvenn(vennJejunum, show_percentage = FALSE,fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
        stroke_size = 0.5, set_name_size = 5) + labs(title = "Jejunum") + theme(plot.title=element_text(hjust=0.5))

vennIleum = read.table("D:/HAUPT_ALL/Ileum/VennIleum1.txt", header=TRUE, sep="\t")
Set1 <- vennIleum$Set1
Set2 <- vennIleum$Set2
Set3 <- vennIleum$Set3
Set4 <- vennIleum$Set4
vennIleum <-list("T1" = Set1, "T2" = Set2, "T3" = Set3, "T4" = Set4)
V3 <- ggvenn(vennIleum, show_percentage = FALSE,fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
        stroke_size = 0.5, set_name_size = 5) + labs(title = "Ileum") + theme(plot.title=element_text(hjust=0.5))

vennCaecum = read.table("D:/HAUPT_ALL/Caecum/VennCaecum1.txt", header=TRUE, sep="\t")
Set1 <- vennCaecum$Set1
Set2 <- vennCaecum$Set2
Set3 <- vennCaecum$Set3
Set4 <- vennCaecum$Set4
vennCaecum <-list("T1" = Set1, "T2" = Set2, "T3" = Set3, "T4" = Set4)
V4 <- ggvenn(vennCaecum, show_percentage = FALSE,fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
        stroke_size = 0.5, set_name_size = 5) + labs(title = "Caecum") + theme(plot.title=element_text(hjust=0.5))

vennColon = read.table("D:/HAUPT_ALL/Colon/VennColon1.txt", header=TRUE, sep="\t")
Set1 <- vennColon$Set1
Set2 <- vennColon$Set2
Set3 <- vennColon$Set3
Set4 <- vennColon$Set4
vennColon <-list("T1" = Set1, "T2" = Set2, "T3" = Set3, "T4" = Set4)
V5 <- ggvenn(vennColon, show_percentage = FALSE,fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
        stroke_size = 0.5, set_name_size = 5) + labs(title = "Colon") + theme(plot.title=element_text(hjust=0.5))

vennRectum = read.table("D:/HAUPT_ALL/Rectum/VennRectum1.txt", header=TRUE, sep="\t")
Set1 <- vennRectum$Set1
Set2 <- vennRectum$Set2
Set3 <- vennRectum$Set3
Set4 <- vennRectum$Set4
vennRectum <-list("T1" = Set1, "T2" = Set2, "T3" = Set3, "T4" = Set4)
V6 <- ggvenn(vennRectum, show_percentage = FALSE,fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
        stroke_size = 0.5, set_name_size = 5) + labs(title = "Rectum") + theme(plot.title=element_text(hjust=0.5))

ggarrange(V1, V2, V3, V4, V5, V6, ncol = 3, nrow =2)

tiff('D:/HAUPT_ALL/Figure1.tiff', pointsize=12, width=2700, height=1800, res=300)

#FIGURE 2 PHYLA RELATIVE ABUNDANCE

set.seed(3711)
library(dplyr)
library(RColorBrewer)

tiff('D:/HAUPT1_ALL/Results/Figure2.tiff', pointsize=12, width=5400, height=3600, res=300)
par(mfrow = c(2, 2))
PhylaTrial1 = read.table("D:/HAUPT1_ALL/Results/TotalPhylumGraph1.txt", header=TRUE, sep="\t")
PhylaTrial1 <- as.data.frame(PhylaTrial1)
row.names(PhylaTrial1) = PhylaTrial1$Phylum
PhylaTrial1$Phylum <- NULL
row.names(PhylaTrial1)[5] <-  "Bacteria UC*"
row.names(PhylaTrial1)[9] <-  "Deinococcus Thermus"
PhylaTrial1 <- as.matrix(PhylaTrial1)
PhylaTrial1[1, ] <- PhylaTrial1[1, ] - 50
par(mar = c(6,4,4,14))
barplot(PhylaTrial1,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 50),
         axes = F,
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(PhylaTrial1),
         args.legend=list(x = "topright", inset = c(-0.35, 0.2), cex=1.2, text.font = 2, bty = "n"))
axis(2, at = seq(0, 50, by = 10), labels = seq(50, 100, by = 10), cex.axis = 1.4, font = 2)
mtext("Trial 1", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)

PhylaTrial2 = read.table("D:/HAUPT2_ALL/Results/TotalPhylumGraph2.txt", header=TRUE, sep="\t")
PhylaTrial2 <- as.data.frame(PhylaTrial2)
row.names(PhylaTrial2) = PhylaTrial2$Phylum
PhylaTrial2$Phylum <- NULL
row.names(PhylaTrial2)[6] <-  "Bacteria UC*"
PhylaTrial2 <- as.matrix(PhylaTrial2)
PhylaTrial2[1, ] <- PhylaTrial2[1, ] - 50
par(mar = c(6,4,4,14))
barplot(PhylaTrial2,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 50),
         axes = F,
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(PhylaTrial2),
         args.legend=list(x = "topright", inset = c(-0.265, 0.2), cex=1.2, text.font = 2, bty = "n"))
axis(2, at = seq(0, 50, by = 10), labels = seq(50, 100, by = 10), cex.axis = 1.4, font = 2)
mtext("Trial 2", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)

PhylaTrial3 = read.table("D:/HAUPT3_ALL/Results/TotalPhylumGraph3.txt", header=TRUE, sep="\t")
PhylaTrial3 <- as.data.frame(PhylaTrial3)
row.names(PhylaTrial3) = PhylaTrial3$Phylum
PhylaTrial3$Phylum <- NULL
row.names(PhylaTrial3)[5] <-  "Bacteria UC*"
row.names(PhylaTrial1)[10] <-  "Deinococcus Thermus"
PhylaTrial3 <- as.matrix(PhylaTrial3)
PhylaTrial3[1, ] <- PhylaTrial3[1, ] - 60
par(mar = c(6,4,4,14))
barplot(PhylaTrial3,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 40),
         axes = F,
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(PhylaTrial3),
         args.legend=list(x = "topright", inset = c(-0.35, 0.2), cex=1.2, text.font = 2, bty = "n"))
axis(2, at = seq(0, 40, by = 10), labels = seq(60, 100, by = 10), cex.axis = 1.4, font = 2)
mtext("Trial 3", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)

PhylaTrial4 = read.table("D:/HAUPT4_ALL/Results/TotalPhylumGraph4.txt", header=TRUE, sep="\t")
PhylaTrial4 <- as.data.frame(PhylaTrial4)
row.names(PhylaTrial4) = PhylaTrial4$Phylum
PhylaTrial4$Phylum <- NULL
row.names(PhylaTrial4)[7] <-  "Bacteria UC*"
PhylaTrial4 <- as.matrix(PhylaTrial4)
PhylaTrial4[1, ] <- PhylaTrial4[1, ] - 50
par(mar = c(6,4,4,14))
barplot(PhylaTrial4,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 50),
         axes = F,
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(PhylaTrial4),
         args.legend=list(x = "topright", inset = c(-0.25, 0.2), cex=1.2, text.font = 2, bty = "n"))
axis(2, at = seq(0, 50, by = 10), labels = seq(50, 100, by = 10), cex.axis = 1.4, font = 2)
mtext("Trial 4", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)
dev.off()

#FIGURE 3 GENUS RELATIVE ABUNDANCE

tiff('D:/HAUPT1_ALL/Results/Figure3.tiff', pointsize=12, width=5400, height=3600, res=300)
par(mfrow = c(2, 2))
GenusTrial1 = read.table("D:/HAUPT1_ALL/Results/TotalGenusGraph1.txt", header=TRUE, sep="\t")
GenusTrial1 <- as.data.frame(GenusTrial1)
row.names(GenusTrial1) = GenusTrial1$Genus
GenusTrial1$Genus <- NULL
row.names(GenusTrial1)[10] <-  "Ruminococcaceae UC*"
GenusTrial1 <- as.matrix(GenusTrial1)
par(mar = c(6,4,4,14))
barplot(GenusTrial1,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 100),
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(GenusTrial1),
         args.legend=list(x = "topright", inset = c(-0.34, 0.2), cex=1.2, text.font = 2, bty = "n"))
mtext("Trial 1", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)

GenusTrial2 = read.table("D:/HAUPT2_ALL/Results/TotalGenusGraph2.txt", header=TRUE, sep="\t")
GenusTrial2 <- as.data.frame(GenusTrial2)
row.names(GenusTrial2) = GenusTrial2$Genus
GenusTrial2$Genus <- NULL
row.names(GenusTrial2)[3] <- "Pasteurellaceae UC*"
GenusTrial2 <- as.matrix(GenusTrial2)
par(mar = c(6,4,4,14))
barplot(GenusTrial2,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 100),
         cex.lab = 1.2,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(GenusTrial2),
         args.legend=list(x = "topright", inset = c(-0.34, 0.2), cex=1.2, text.font = 2, bty = "n"))
mtext("Trial 2", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)

GenusTrial3 = read.table("D:/HAUPT3_ALL/Results/TotalGenusGraph3.txt", header=TRUE, sep="\t")
GenusTrial3 <- as.data.frame(GenusTrial3)
row.names(GenusTrial3) = GenusTrial3$Genus
GenusTrial3$Genus <- NULL
row.names(GenusTrial3)[9] <- "Ruminococcaceae UC*"
GenusTrial3 <- as.matrix(GenusTrial3)
par(mar = c(6,4,4,14))
barplot(GenusTrial3,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 100),
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(GenusTrial3),
         args.legend=list(x = "topright", inset = c(-0.34, 0.2), cex=1.2, text.font = 2, bty = "n"))
mtext("Trial 3", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)

GenusTrial4 = read.table("D:/HAUPT4_ALL/Results/TotalGenusGraph4.txt", header=TRUE, sep="\t")
GenusTrial4 <- as.data.frame(GenusTrial4)
row.names(GenusTrial4) = GenusTrial4$Genus
GenusTrial4$Genus <- NULL
row.names(GenusTrial4)[6] <- "Enterobacteriaceae UC*"
GenusTrial4 <- as.matrix(GenusTrial4)
par(mar = c(6,4,4,14))
barplot(GenusTrial4,
         width = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
         names.arg = c("NGD", "GD", "NGJ", "GJ", "NGI", "GI", "NGC", "GC", "NGCA", "GCA", "NGR", "GR"),
         col = brewer.pal(n = 12, name = "Set3"),
         ylab = "Relative Abundance %",
         ylim = c(0, 100),
         cex.lab = 1.4,
         las = 3,
         font = 2,
         font.lab = 2,
         cex.axis = 1.4,
         cex.names = 1.4,
         legend.text = rownames(GenusTrial4),
         args.legend=list(x = "topright", inset = c(-0.34, 0.2), cex=1.2, text.font = 2, bty = "n"))
mtext("Trial 4", side=3, adj=0, line=1, cex=1.4, font=2, font.lab = 2)
dev.off()

#FIGURE 5 GUT ARCHITECTURE

tiff("D:/Figure5.tiff", pointsize=12, width=2700, height=1800, res=300)
par(mfrow = c(2,3))
VHJejunum=read.table("D:/VHJejunum.txt", header=TRUE, sep="\t")
View(VHJejunum)
h1 <- (VHJejunum$VH1C)
h2 <- (VHJejunum$VH1G)
h3 <- (VHJejunum$VH2C)
h4 <- (VHJejunum$VH2G)
h5 <- (VHJejunum$VH3C)
h6 <- (VHJejunum$VH3G)
h7 <- (VHJejunum$VH4C)
h8 <- (VHJejunum$VH4G)
par(font.axis = 2)
boxplot(h1, h2, h3, h4, h5, h6, h7, h8,
                  ylab = expression(bold(paste("Height ", mu, "m"))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.,
                  cex.lab = 1.,
                  cex.axis = 1.)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 2, y = 640, label ="**", cex = 1.2, font = 2)
text(x = 3, y = 500, label ="**", cex = 1.2, font = 2)
text(x = 6, y = 775, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 660, label ="***", cex = 1.2, font = 2)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3)
mtext("Jejunum", side=3, adj=0, line=2, cex=1, font=2, font.lab = 2)
mtext("Villus Height", side=3, adj=0.5, line=0.6, cex=0.8, font=2, font.lab = 2)

CDJejunum=read.table("D:/CDJejunum.txt", header=TRUE, sep="\t")
View(CDJejunum)
hhh1 <- (CDJejunum$CD1C)
hhh2 <- (CDJejunum$CD1G)
hhh3 <- (CDJejunum$CD2C)
hhh4 <- (CDJejunum$CD2G)
hhh5 <- (CDJejunum$CD3C)
hhh6 <- (CDJejunum$CD3G)
hhh7 <- (CDJejunum$CD4C)
hhh8 <- (CDJejunum$CD4G)
par(font.axis = 2)
boxplot(hhh1, hhh2, hhh3, hhh4, hhh5, hhh6, hhh7, hhh8,
                  ylab = expression(bold(paste("Depth ", mu, "m"))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.,
                  cex.lab = 1.,
                  cex.axis = 1.)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3)
mtext("Crypt Depth", side=3, adj=0.5, line=0.6, cex=0.8, font=2, font.lab = 2)

VCRJejunum=read.table("D:/VCRJejunum.txt", header=TRUE, sep="\t")
View(VCRJejunum)
vvv1 <- (VCRJejunum$VCR1C)
vvv2 <- (VCRJejunum$VCR1G)
vvv3 <- (VCRJejunum$VCR2C)
vvv4 <- (VCRJejunum$VCR2G)
vvv5 <- (VCRJejunum$VCR3C)
vvv6 <- (VCRJejunum$VCR3G)
vvv7 <- (VCRJejunum$VCR4C)
vvv8 <- (VCRJejunum$VCR4G)
par(font.axis = 2)
boxplot(vvv1, vvv2, vvv3, vvv4, vvv5, vvv6, vvv7, vvv8,
                  ylab=expression(bold("Ratio")),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.,
                  cex.lab = 1.,
                  cex.axis = 1.)
text(x = 2, y = 2.9, label ="*", cex = 1.2, font = 2)
text(x = 3, y = 2.4, label ="**", cex = 1.2, font = 2)
text(x = 6, y = 4, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 2.7, label ="***", cex = 1.2, font = 2)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3)
mtext("Villus Crypt Ratio", side=3, adj=0.5, line=0.6, cex=0.8, font=2, font.lab = 2)

VHIleum=read.table("D:/VHIleum.txt", header=TRUE, sep="\t")
View(VHIleum)
hh1 <- (VHIleum$VH1C)
hh2 <- (VHIleum$VH1G)
hh3 <- (VHIleum$VH2C)
hh4 <- (VHIleum$VH2G)
hh5 <- (VHIleum$VH3C)
hh6 <- (VHIleum$VH3G)
hh7 <- (VHIleum$VH4C)
hh8 <- (VHIleum$VH4G)
par(font.axis = 2)
boxplot(hh1, hh2, hh3, hh4, hh5, hh6, hh7, hh8,
                  ylab = expression(bold(paste("Height ", mu, "m"))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.,
                  cex.lab = 1.,
                  cex.axis = 1.)
text(x = 6, y = 520, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 510, label ="***", cex = 1.2, font = 2)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3)
mtext("Ileum", side=3, adj=0, line=2, cex=1.2, font=2, font.lab = 2)
mtext("Villus Height", side=3, adj=0.5, line=0.6, cex=0.8, font=2, font.lab = 2)

CDIleum=read.table("D:/CDIleum.txt", header=TRUE, sep="\t")
View(CDIleum)
hhhh1 <- (CDIleum$CD1C)
hhhh2 <- (CDIleum$CD1G)
hhhh3 <- (CDIleum$CD2C)
hhhh4 <- (CDIleum$CD2G)
hhhh5 <- (CDIleum$CD3C)
hhhh6 <- (CDIleum$CD3G)
hhhh7 <- (CDIleum$CD4C)
hhhh8 <- (CDIleum$CD4G)
par(font.axis = 2)
boxplot(hhhh1, hhh2, hhhh3, hhhh4, hhhh5, hhhh6, hhhh7, hhhh8,
                  ylab = expression(bold(paste("Depth ", mu, "m"))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.,
                  cex.lab = 1.,
                  cex.axis = 1.)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3)
mtext("Crypt Depth", side=3, adj=0.5, line=0.6, cex=0.8, font=2, font.lab = 2)

VCRIleum=read.table("D:/VCRIleum.txt", header=TRUE, sep="\t")
View(VCRIleum)
vvvv1 <- (VCRIleum$VCR1C)
vvvv2 <- (VCRIleum$VCR1G)
vvvv3 <- (VCRIleum$VCR2C)
vvvv4 <- (VCRIleum$VCR2G)
vvvv5 <- (VCRIleum$VCR3C)
vvvv6 <- (VCRIleum$VCR3G)
vvvv7 <- (VCRIleum$VCR4C)
vvvv8 <- (VCRIleum$VCR4G)
par(font.axis = 2)
boxplot(vvvv1, vvvv2, vvvv3, vvvv4, vvvv5, vvvv6, vvvv7, vvvv8,
                  ylab=expression(bold("Ratio")),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.,
                  cex.lab = 1.,
                  cex.axis = 1.)
text(x = 6, y = 3.4, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 2.4, label ="***", cex = 1.2, font = 2)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3)
mtext("Villus Crypt Ratio", side=3, adj=0.5, line=0.6, cex=0.8, font=2, font.lab = 2)
dev.off()

#FIGURE 6 GOBLET CELLS

tiff('D:/Figure6.tiff', pointsize=10, width=2400, height=2600, res=300)
par(mar = c(6, 4.1, 4.1, 2.1))
par(mfrow = c(3,2))
JejunumGC = read.table("D:/JejunumGC.txt", header=TRUE, sep="\t")
View(JejunumGC)
j1 <- (JejunumGC$GCMVC1)
j2 <- (JejunumGC$GCMVG1)
j3 <- (JejunumGC$GCMVC2)
j4 <- (JejunumGC$GCMVG2)
j5 <- (JejunumGC$GCMVC3)
j6 <- (JejunumGC$GCMV3)
j7 <- (JejunumGC$GCMVC4)
j8 <- (JejunumGC$GCMV4)
par(font.axis = 2)
boxplot(j1, j2, j3, j4, j5, j6, j7, j8,
                  ylab = expression(bold(paste("Goblet Cells mm"^2))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.2,
                  cex.lab = 1.2,
                  cex.axis = 1.2,
                  ylim = c(0, 1.5))
legend("top", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1.2, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3, cex.axis = 1.2)
mtext("Number of Goblet Cells", side=3, adj=0, line=2, cex=1.0, font=2, font.lab = 2)
mtext("Jejunal Villus", side=3, adj=0.5, line=0.6, cex=1.0, font=2, font.lab = 2)
text(x = 2, y = 1.35, label ="**", cex = 1.2, font = 2)
text(x = 6, y = 0.8, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 0.8, label ="***", cex = 1.2, font = 2)

jj1 <- (JejunumGC$GCMCC1)
jj2 <- (JejunumGC$GCMCG1)
jj3 <- (JejunumGC$GCMCC2)
jj4 <- (JejunumGC$GCMCG2)
jj5 <- (JejunumGC$GCMCC3)
jj6 <- (JejunumGC$GCMCG3)
jj7 <- (JejunumGC$GCMCC4)
jj8 <- (JejunumGC$GCMCG4)
par(font.axis = 2)
boxplot(jj1, jj2, jj3, jj4, jj5, jj6, jj7, jj8,
                  ylab = expression(bold(paste("Goblet Cells mm"^2))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.2,
                  cex.lab = 1.2,
                  cex.axis = 1.2,
                  ylim = c(0, 4))
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3, cex.axis = 1.2)
mtext("Jejunal Crypt", side=3, adj=0.5, line=0.6, cex=1, font=2, font.lab = 2)
text(x = 2, y = 3.7, label ="***", cex = 1.2, font = 2)
text(x = 6, y = 3.25, label ="***", cex = 1.2, font = 2)

IleumGC = read.table("D:/IlleumGC.txt", header=TRUE, sep="\t")
View(IlleumGC)
i1 <- (IlleumGC$GCMVC1)
i2 <- (IlleumGC$GCMVG1)
i3 <- (IlleumGC$GCMVC2)
i4 <- (IlleumGC$GCMVG2)
i5 <- (IlleumGC$GCMVC3)
i6 <- (IlleumGC$GCMV3)
i7 <- (IlleumGC$GCMVC4)
i8 <- (IlleumGC$GCMV4)
par(font.axis = 2)
boxplot(i1, i2, i3, i4, i5, i6, i7, i8,
                  ylab = expression(bold(paste("Goblet Cells mm"^2))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.2,
                  cex.lab = 1.2,
                  cex.axis = 1.2)
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3, cex.axis = 1.2)
mtext("Ileal Villus", side=3, adj=0.5, line=0.6, cex=1, font=2, font.lab = 2)
text(x = 4, y = 1.2, label ="*", cex = 1.2, font = 2)
text(x = 6, y = 1.2, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 1.2, label ="***", cex = 1.2, font = 2)

ii1 <- (IlleumGC$GCMCC1)
ii2 <- (IlleumGC$GCMCG1)
ii3 <- (IlleumGC$GCMCC2)
ii4 <- (IlleumGC$GCMCG2)
ii5 <- (IlleumGC$GCMCC3)
ii6 <- (IlleumGC$GCMCG3)
ii7 <- (IlleumGC$GCMCC4)
ii8 <- (IlleumGC$GCMCG4)
par(font.axis = 2)
boxplot(ii1, ii2, ii3, ii4, ii5, ii6, ii7, ii8,
                  ylab = expression(bold(paste("Goblet Cells mm"^2))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.1,
                  cex.lab = 1.1,
                  cex.axis = 1.1,
                  ylim = c(0, 4))
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3, cex.axis = 1.2)
mtext("Ileal Crypt", side=3, adj=0.5, line=0.6, cex=1, font=2, font.lab = 2)
text(x = 6, y = 3.8, label ="***", cex = 1.2, font = 2)
text(x = 8, y = 3.8, label ="***", cex = 1.2, font = 2)

ColonGCDensity = read.table("D:/GCColonCrypt.txt", header=TRUE, sep="\t")
View(ColonGCDensity)
iii1 <- (ColonGCDensity$GCMCC1)
iii2 <- (ColonGCDensity$GCMCG1)
iii3 <- (ColonGCDensity$GCMCC2)
iii4 <- (ColonGCDensity$GCMCG2)
iii5 <- (ColonGCDensity$GCMCC3)
iii6 <- (ColonGCDensity$GCMCG3)
iii7 <- (ColonGCDensity$GCMCC4)
iii8 <- (ColonGCDensity$GCMCG4)
par(font.axis = 2)
boxplot(iii1, iii2, iii3, iii4, iii5, iii6, iii7, iii8,
                  ylab = expression(bold(paste("Goblet Cells mm"^2))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.2,
                  cex.lab = 1.2,
                  cex.axis = 1.2,
                  ylim = c(0, 6))
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3, cex.axis = 1.2)
mtext("Colonic Crypt", side=3, adj=0.5, line=0.6, cex=1, font=2, font.lab = 2)
text(x = 4, y = 5, label ="**", cex = 1.2, font = 2)

CecumGCDensity = read.table("D:/GCCecumCrypt.txt", header=TRUE, sep="\t")
View(ColonGCDensity)
iiii1 <- (CecumGCDensity$GCMC1)
iiii2 <- (CecumGCDensity$GCMCG1)
iiii3 <- (CecumGCDensity$GCMC2)
iiii4 <- (CecumGCDensity$GCMCG2)
iiii5 <- (CecumGCDensity$GCMC3)
iiii6 <- (CecumGCDensity$GCMCG3)
iiii7 <- (CecumGCDensity$GCMC4)
iiii8 <- (CecumGCDensity$GCMCG4)
par(font.axis = 2)
boxplot(iiii1, iiii2, iiii3, iiii4, iiii5, iiii6, iii7, iiii8,
                  ylab = expression(bold(paste("Goblet Cells mm"^2))),
                  col=(c("#7570B3","#E7298A")),
                  pch = 20,
                  xaxt="n",
                  cex = 1.2,
                  cex.lab = 1.2,
                  cex.axis = 1.2,
                  ylim = c(0, 6))
axis(1, at = c(1.5, 3.5, 5.5, 7.5),
labels = c("Trial 1", "Trial 2", "Trial 3", "Trial 4"), las = 3, cex.axis = 1.2)
mtext("Caecal Crypt", side=3, adj=0.5, line=0.6, cex=1, font=2, font.lab = 2)
text(x = 6, y = 5.5, label ="***", cex = 1.2, font = 2)
dev.off()

#SUPPLEMENTARY FIGURE 1

WeightCorr = read.table("D:/WeightCorr.txt", header=TRUE, sep="\t")
View(WeightCorr)
tiff('D:/Supplementary1.tiff', pointsize=10, width=2600, height=2400, res=600)
plot(WeightCorr$X24h_BWC, WeightCorr$P4._WeightC,
      pch = 20,
      cex = 1,
      cex.axis = 1,
      font.lab = 2,
      font = 2,
      col = "#7570B3",
      xlab = "Weight at 24h post partum Kg",
      ylab = "Final Weight Kg",
      xlim = c(0.5, 1.8),
      ylim = c(1, 6.5))
      points(WeightCorr$X24h_BWG, WeightCorr$P4._WeightG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(WeightCorr$P4._WeightC ~ WeightCorr$X24h_BWC), col = "#7570B3", lwd = 2)
abline(lm(WeightCorr$P4._WeightG ~ WeightCorr$X24h_BWG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 1.6, y = 2.6, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 1.6, y = 2.3, label = substitute(paste(italic("R"^2), " = 0.50")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 1.6, y = 1.7, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 1.6, y = 1.4, label = substitute(paste(italic("R"^2), " = 0.48")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Piglet weight at 24h correlates with final end of study weight", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)
dev.off()

#SUPPLEMENTARY FIGURE 3A

tiff("D:/RFigure/Trial1BetaDiversity1.tiff", pointsize=12, width=7200, height=3800, res=400)
par(mfrow = c(3,6))
par(mar = c(6,6,3,2))

ThetaYCHAUPT1Duodenum = read.table("D:/HAUPT1_Updated/Duodenum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa1.axes", header=TRUE, sep="\t")
ThetaYCHAUPT1Duodenum = ThetaYCHAUPT1Duodenum[,-which(names(ThetaYCHAUPT1Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
ThetaYCHAUPT1Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT1Duodenum <- ThetaYCHAUPT1Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT1Duodenum$axis1, ThetaYCHAUPT1Duodenum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT1Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (81.49 %)",
      ylab = "PC2  (6.98 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.246")), font = 2, col = "black"))
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, col = my_palette3)
mtext("Duodenum", side=3, adj=0, line=0.6, cex=0.8, font=2)
mtext("Yue & Clayton Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

ThetaYCHAUPT1Jejunum = read.table("D:/HAUPT1_Updated/Jejunum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa2.axes", header=TRUE, sep="\t")
ThetaYCHAUPT1Jejunum = ThetaYCHAUPT1Jejunum[,-which(names(ThetaYCHAUPT1Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
ThetaYCHAUPT1Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT1Jejunum <- ThetaYCHAUPT1Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT1Jejunum$axis1, ThetaYCHAUPT1Jejunum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT1Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (68.64 %)",
      ylab = "PC2  (12.42 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.293")), font = 2, col = "black"))
mtext("Jejunum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT1Ileum = read.table("D:/HAUPT1_Updated/Ileum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa3.axes", header=TRUE, sep="\t")
ThetaYCHAUPT1Ileum = ThetaYCHAUPT1Ileum[,-which(names(ThetaYCHAUPT1Ileum) %in% c("axis3", "axis4", "axis5", "axis6"))]
ThetaYCHAUPT1Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT1Ileum <- ThetaYCHAUPT1Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT1Ileum$axis1, ThetaYCHAUPT1Ileum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT1Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (68.86 %)",
      ylab = "PC2  (21.54 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.373")), font = 2, col = "black"))
mtext("Ileum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT1Caecum = read.table("D:/HAUPT1_Updated/Caecum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa4.axes", header=TRUE, sep="\t")
ThetaYCHAUPT1Caecum = ThetaYCHAUPT1Caecum[,-which(names(ThetaYCHAUPT1Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT1Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT1Caecum <- ThetaYCHAUPT1Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT1Caecum$axis1, ThetaYCHAUPT1Caecum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT1Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (52.06 %)",
      ylab = "PC2  (20.53 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.517")), font = 2, col = "black"))
mtext("Caecum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT1Colon = read.table("D:/HAUPT1_Updated/Colon/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa5.axes", header=TRUE, sep="\t")
ThetaYCHAUPT1Colon = ThetaYCHAUPT1Colon[,-which(names(ThetaYCHAUPT1Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT1Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT1Colon <- ThetaYCHAUPT1Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT1Colon$axis1, ThetaYCHAUPT1Colon$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT1Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.7, 0.7),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (39.91 %)",
      ylab = "PC2  (37.58 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.173")), font = 2, col = "black"))
mtext("Colon", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT1Rectum = read.table("D:/HAUPT1_Updated/Rectum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa6.axes", header=TRUE, sep="\t")
ThetaYCHAUPT1Rectum = ThetaYCHAUPT1Rectum[,-which(names(ThetaYCHAUPT1Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
ThetaYCHAUPT1Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT1Rectum <- ThetaYCHAUPT1Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT1Rectum$axis1, ThetaYCHAUPT1Rectum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT1Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (46.46 %)",
      ylab = "PC2  (35.18 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.031")), font = 2, col = "black"))
mtext("Rectum", side=3, adj=0, line=0.6, cex=0.8, font=2)

BrayCurtisHAUPT1Duodenum = read.table("D:/HAUPT1_Updated/Duodenum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa1.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT1Duodenum = BrayCurtisHAUPT1Duodenum[,-which(names(BrayCurtisHAUPT1Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
BrayCurtisHAUPT1Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT1Duodenum <- BrayCurtisHAUPT1Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT1Duodenum$axis1, BrayCurtisHAUPT1Duodenum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT1Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (69.39 %)",
      ylab = "PC2  (12.62 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.186")), font = 2, col = "black"))
mtext("Bray-Curtis Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

BrayCurtisHAUPT1Jejunum = read.table("D:/HAUPT1_Updated/Jejunum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa2.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT1Jejunum = BrayCurtisHAUPT1Jejunum[,-which(names(BrayCurtisHAUPT1Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
BrayCurtisHAUPT1Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT1Jejunum <- BrayCurtisHAUPT1Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT1Jejunum$axis1, BrayCurtisHAUPT1Jejunum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT1Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (56.80 %)",
      ylab = "PC2  (20.39 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.217")), font = 2, col = "black"))

BrayCurtisHAUPT1Ileum = read.table("D:/HAUPT1_Updated/Ileum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa3.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT1Ileum = BrayCurtisHAUPT1Ileum[,-which(names(BrayCurtisHAUPT1Ileum) %in% c("axis3", "axis4", "axis5", "axis6"))]
BrayCurtisHAUPT1Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT1Ileum <- BrayCurtisHAUPT1Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT1Ileum$axis1, BrayCurtisHAUPT1Ileum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT1Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (63.16 %)",
      ylab = "PC2  (16.90 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.173")), font = 2, col = "black"))

BrayCurtisHAUPT1Caecum = read.table("D:/HAUPT1_Updated/Caecum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa4.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT1Caecum = BrayCurtisHAUPT1Caecum[,-which(names(BrayCurtisHAUPT1Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT1Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT1Caecum <- BrayCurtisHAUPT1Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT1Caecum$axis1, BrayCurtisHAUPT1Caecum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT1Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (36.88 %)",
      ylab = "PC2  (24.11 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.427")), font = 2, col = "black"))

BrayCurtisHAUPT1Colon = read.table("D:/HAUPT1_Updated/Colon/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa5.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT1Colon = BrayCurtisHAUPT1Colon[,-which(names(BrayCurtisHAUPT1Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT1Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT1Colon <- BrayCurtisHAUPT1Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT1Colon$axis1, BrayCurtisHAUPT1Colon$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT1Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (38.15 %)",
      ylab = "PC2  (27.50 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.254")), font = 2, col = "black"))

BrayCurtisHAUPT1Rectum = read.table("D:/HAUPT1_Updated/Rectum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa6.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT1Rectum = BrayCurtisHAUPT1Rectum[,-which(names(BrayCurtisHAUPT1Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
BrayCurtisHAUPT1Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT1Rectum <- BrayCurtisHAUPT1Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT1Rectum$axis1, BrayCurtisHAUPT1Rectum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT1Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (39.09 %)",
      ylab = "PC2  (30.48 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.062")), font = 2, col = "black"))

JaccardHAUPT1Duodenum = read.table("D:/HAUPT1_Updated/Duodenum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa1.axes", header=TRUE, sep="\t")
JaccardHAUPT1Duodenum = JaccardHAUPT1Duodenum[,-which(names(JaccardHAUPT1Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
JaccardHAUPT1Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT1Duodenum <- JaccardHAUPT1Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT1Duodenum$axis1, JaccardHAUPT1Duodenum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT1Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (26.80 %)",
      ylab = "PC2  (20.84 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.062")), font = 2, col = "black"))
mtext("Jaccard Similarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

JaccardHAUPT1Jejunum = read.table("D:/HAUPT1_Updated/Jejunum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa2.axes", header=TRUE, sep="\t")
JaccardHAUPT1Jejunum = JaccardHAUPT1Jejunum[,-which(names(JaccardHAUPT1Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
JaccardHAUPT1Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT1Jejunum <- JaccardHAUPT1Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT1Jejunum$axis1, JaccardHAUPT1Jejunum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT1Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (26.68 %)",
      ylab = "PC2  (17.00 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.660")), font = 2, col = "black"))

JaccardHAUPT1Ileum = read.table("D:/HAUPT1_Updated/Ileum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa3.axes", header=TRUE, sep="\t")
JaccardHAUPT1Ileum = JaccardHAUPT1Ileum[,-which(names(JaccardHAUPT1Ileum) %in% c("axis3", "axis4", "axis5", "axis6"))]
JaccardHAUPT1Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT1Ileum <- JaccardHAUPT1Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT1Ileum$axis1, JaccardHAUPT1Ileum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT1Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (44.60 %)",
      ylab = "PC2  (17.11 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.09")), font = 2, col = "black"))

JaccardHAUPT1Caecum = read.table("D:/HAUPT1_Updated/Caecum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa4.axes", header=TRUE, sep="\t")
JaccardHAUPT1Caecum = JaccardHAUPT1Caecum[,-which(names(JaccardHAUPT1Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT1Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT1Caecum <- JaccardHAUPT1Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT1Caecum$axis1, JaccardHAUPT1Caecum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT1Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (24.68 %)",
      ylab = "PC2  (18.38 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.106")), font = 2, col = "black"))

JaccardHAUPT1Colon = read.table("D:/HAUPT1_Updated/Colon/stability.opti_mcc.jclass.0.03.lt.ave.pcoa5.axes", header=TRUE, sep="\t")
JaccardHAUPT1Colon = JaccardHAUPT1Colon[,-which(names(JaccardHAUPT1Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT1Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT1Colon <- JaccardHAUPT1Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT1Colon$axis1, JaccardHAUPT1Colon$axis2,
      col = my_palette3[as.factor(JaccardHAUPT1Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (24.38 %)",
      ylab = "PC2  (18.55 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.106")), font = 2, col = "black"))

JaccardHAUPT1Rectum = read.table("D:/HAUPT1_Updated/Rectum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa6.axes", header=TRUE, sep="\t")
JaccardHAUPT1Rectum = JaccardHAUPT1Rectum[,-which(names(JaccardHAUPT1Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
JaccardHAUPT1Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT1Rectum <- JaccardHAUPT1Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT1Rectum$axis1, JaccardHAUPT1Rectum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT1Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (34.31 %)",
      ylab = "PC2  (18.86 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.241")), font = 2, col = "black"))
dev.off()

#SUPPLEMENTARY FIGURE 3B

tiff("F:/RFigure/Trial2BetaDiversity2.tiff", pointsize=12, width=7200, height=3800, res=400)
par(mfrow = c(3,6))
par(mar = c(6,6,3,2))

ThetaYCHAUPT2Duodenum = read.table("D:/HAUPT2_Updated/Duodenum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa7.axes", header=TRUE, sep="\t")
ThetaYCHAUPT2Duodenum = ThetaYCHAUPT2Duodenum[,-which(names(ThetaYCHAUPT2Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT2Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT2Duodenum <- ThetaYCHAUPT2Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT2Duodenum$axis1, ThetaYCHAUPT2Duodenum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT2Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (53.41 %)",
      ylab = "PC2  (30.46 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.012")), font = 2, col = "black"))
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, col = my_palette3)
mtext("Duodenum", side=3, adj=0, line=0.6, cex=0.8, font=2)
mtext("Yue & Clayton Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

ThetaYCHAUPT2Jejunum = read.table("D:/HAUPT2_Updated/Jejunum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa8.axes", header=TRUE, sep="\t")
ThetaYCHAUPT2Jejunum = ThetaYCHAUPT2Jejunum[,-which(names(ThetaYCHAUPT2Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT2Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT2Jejunum <- ThetaYCHAUPT2Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT2Jejunum$axis1, ThetaYCHAUPT2Jejunum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT2Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (41.57 %)",
      ylab = "PC2  (35.17 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.015")), font = 2, col = "black"))
mtext("Jejunum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT2Ileum = read.table("D:/HAUPT2_Updated/Ileum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa9.axes", header=TRUE, sep="\t")
ThetaYCHAUPT2Ileum = ThetaYCHAUPT2Ileum[,-which(names(ThetaYCHAUPT2Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT2Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT2Ileum <- ThetaYCHAUPT2Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT2Ileum$axis1, ThetaYCHAUPT2Ileum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT2Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (50.36 %)",
      ylab = "PC2  (24.29 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.284")), font = 2, col = "black"))
mtext("Ileum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT2Caecum = read.table("D:/HAUPT2_Updated/Caecum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa10.axes", header=TRUE, sep="\t")
ThetaYCHAUPT2Caecum = ThetaYCHAUPT2Caecum[,-which(names(ThetaYCHAUPT2Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT2Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT2Caecum <- ThetaYCHAUPT2Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT2Caecum$axis1, ThetaYCHAUPT2Caecum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT2Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.7, 0.7),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (33.32 %)",
      ylab = "PC2  (22.68 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.011")), font = 2, col = "black"))
mtext("Caecum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT2Colon = read.table("D:/HAUPT2_Updated/Colon/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa.axes11", header=TRUE, sep="\t")
ThetaYCHAUPT2Colon = ThetaYCHAUPT2Colon[,-which(names(ThetaYCHAUPT2Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT2Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT2Colon <- ThetaYCHAUPT2Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT2Colon$axis1, ThetaYCHAUPT2Colon$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT2Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (33.34 %)",
      ylab = "PC2  (23.34 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.047")), font = 2, col = "black"))
mtext("Colon", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT2Rectum = read.table("D:/HAUPT2_Updated/Rectum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa.axes12", header=TRUE, sep="\t")
ThetaYCHAUPT2Rectum = ThetaYCHAUPT2Rectum[,-which(names(ThetaYCHAUPT2Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT2Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT2Rectum <- ThetaYCHAUPT2Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT2Rectum$axis1, ThetaYCHAUPT2Rectum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT2Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (29.92 %)",
      ylab = "PC2  (25.24 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.313")), font = 2, col = "black"))
mtext("Rectum", side=3, adj=0, line=0.6, cex=0.8, font=2)

BrayCurtisHAUPT2Duodenum = read.table("D:/HAUPT2_Updated/Duodenum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa7.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT2Duodenum = BrayCurtisHAUPT2Duodenum[,-which(names(BrayCurtisHAUPT2Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT2Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT2Duodenum <- BrayCurtisHAUPT2Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT2Duodenum$axis1, BrayCurtisHAUPT2Duodenum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT2Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (46.46 %)",
      ylab = "PC2  (28.58 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.01")), font = 2, col = "black"))
mtext("Bray-Curtis Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

BrayCurtisHAUPT2Jejunum = read.table("D:/HAUPT2_Updated/Jejunum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa8.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT2Jejunum = BrayCurtisHAUPT2Jejunum[,-which(names(BrayCurtisHAUPT2Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT2Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT2Jejunum <- BrayCurtisHAUPT2Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT2Jejunum$axis1, BrayCurtisHAUPT2Jejunum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT2Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (40.84 %)",
      ylab = "PC2  (28.95 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.012")), font = 2, col = "black"))

BrayCurtisHAUPT2Ileum = read.table("D:/HAUPT2_Updated/Ileum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa9.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT2Ileum = BrayCurtisHAUPT2Ileum[,-which(names(BrayCurtisHAUPT2Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT2Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT2Ileum <- BrayCurtisHAUPT2Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT2Ileum$axis1, BrayCurtisHAUPT2Ileum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT2Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (47.96 %)",
      ylab = "PC2  (21.71 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.155")), font = 2, col = "black"))

BrayCurtisHAUPT2Caecum = read.table("D:/HAUPT2_Updated/Caecum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa10.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT2Caecum = BrayCurtisHAUPT2Caecum[,-which(names(BrayCurtisHAUPT2Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT2Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT2Caecum <- BrayCurtisHAUPT2Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT2Caecum$axis1, BrayCurtisHAUPT2Caecum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT2Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (31.41 %)",
      ylab = "PC2  (23.07 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.006")), font = 2, col = "black"))

BrayCurtisHAUPT2Colon = read.table("D:/HAUPT2_Updated/Colon/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa11.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT2Colon = BrayCurtisHAUPT2Colon[,-which(names(BrayCurtisHAUPT2Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT2Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT2Colon <- BrayCurtisHAUPT2Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT2Colon$axis1, BrayCurtisHAUPT2Colon$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT2Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (32.95 %)",
      ylab = "PC2  (21.43 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.087")), font = 2, col = "black"))

BrayCurtisHAUPT2Rectum = read.table("D:/HAUPT2_Updated/Rectum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa12.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT2Rectum = BrayCurtisHAUPT2Rectum[,-which(names(BrayCurtisHAUPT2Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT2Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT2Rectum <- BrayCurtisHAUPT2Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT2Rectum$axis1, BrayCurtisHAUPT2Rectum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT2Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (27.11 %)",
      ylab = "PC2  (24.59 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.197")), font = 2, col = "black"))

JaccardHAUPT2Duodenum = read.table("D:/HAUPT2_Updated/Duodenum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa7.axes", header=TRUE, sep="\t")
JaccardHAUPT2Duodenum = JaccardHAUPT2Duodenum[,-which(names(JaccardHAUPT2Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT2Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT2Duodenum <- JaccardHAUPT2Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT2Duodenum$axis1, JaccardHAUPT2Duodenum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT2Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (28.99 %)",
      ylab = "PC2  (16.10 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.031")), font = 2, col = "black"))
mtext("Jaccard Similarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

JaccardHAUPT2Jejunum = read.table("D:/HAUPT2_Updated/Jejunum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa8.axes", header=TRUE, sep="\t")
JaccardHAUPT2Jejunum = JaccardHAUPT2Jejunum[,-which(names(JaccardHAUPT2Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT2Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT2Jejunum <- JaccardHAUPT2Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT2Jejunum$axis1, JaccardHAUPT2Jejunum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT2Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (29.39 %)",
      ylab = "PC2  (13.13 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.025")), font = 2, col = "black"))

JaccardHAUPT2Ileum = read.table("D:/HAUPT2_Updated/Ileum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa9.axes", header=TRUE, sep="\t")
JaccardHAUPT2Ileum = JaccardHAUPT2Ileum[,-which(names(JaccardHAUPT2Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT2Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT2Ileum <- JaccardHAUPT2Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT2Ileum$axis1, JaccardHAUPT2Ileum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT2Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (29.35 %)",
      ylab = "PC2  (17.42 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.126")), font = 2, col = "black"))

JaccardHAUPT2Caecum = read.table("D:/HAUPT2_Updated/Caecum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa10.axes", header=TRUE, sep="\t")
JaccardHAUPT2Caecum = JaccardHAUPT2Caecum[,-which(names(JaccardHAUPT2Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT2Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT2Caecum <- JaccardHAUPT2Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT2Caecum$axis1, JaccardHAUPT2Caecum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT2Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (20.79 %)",
      ylab = "PC2  (20.37 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.016")), font = 2, col = "black"))

JaccardHAUPT2Colon = read.table("D:/HAUPT2_Updated/Colon/stability.opti_mcc.jclass.0.03.lt.ave.pcoa11.axes", header=TRUE, sep="\t")
JaccardHAUPT2Colon = JaccardHAUPT2Colon[,-which(names(JaccardHAUPT2Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT2Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT2Colon <- JaccardHAUPT2Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT2Colon$axis1, JaccardHAUPT2Colon$axis2,
      col = my_palette3[as.factor(JaccardHAUPT2Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (23.36 %)",
      ylab = "PC2  (15.22 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.140")), font = 2, col = "black"))

JaccardHAUPT2Rectum = read.table("D:/HAUPT2_Updated/Rectum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa12.axes", header=TRUE, sep="\t")
JaccardHAUPT2Rectum = JaccardHAUPT2Rectum[,-which(names(JaccardHAUPT2Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT2Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT2Rectum <- JaccardHAUPT2Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT2Rectum$axis1, JaccardHAUPT2Rectum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT2Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (19.71 %)",
      ylab = "PC2  (17.25 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.006")), font = 2, col = "black"))
dev.off()

#SUPPLEMENTARY FIGURE 3C

tiff("F:/RFigure/Trial3BetaDiversity2.tiff", pointsize=12, width=7200, height=3800, res=400)
par(mfrow = c(3,6))
par(mar = c(6,6,3,2))

ThetaYCHAUPT3Duodenum = read.table("D:/HAUPT3_Updated/Duodenum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa13.axes", header=TRUE, sep="\t")
ThetaYCHAUPT3Duodenum = ThetaYCHAUPT3Duodenum[,-which(names(ThetaYCHAUPT3Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
ThetaYCHAUPT3Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT3Duodenum <- ThetaYCHAUPT3Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT3Duodenum$axis1, ThetaYCHAUPT3Duodenum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT3Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (75.39 %)",
      ylab = "PC2  (13.87 %)",
      font.lab = 2,
      font = 2,
      text(x = 0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.486")), font = 2, col = "black"))
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, col = my_palette3)
mtext("Duodenum", side=3, adj=0, line=0.6, cex=0.8, font=2)
mtext("Yue & Clayton Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

ThetaYCHAUPT3Jejunum = read.table("D:/HAUPT3_Updated/Jejunum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa14.axes", header=TRUE, sep="\t")
ThetaYCHAUPT3Jejunum = ThetaYCHAUPT3Jejunum[,-which(names(ThetaYCHAUPT3Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT3Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT3Jejunum <- ThetaYCHAUPT3Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT3Jejunum$axis1, ThetaYCHAUPT3Jejunum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT3Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (71.99 %)",
      ylab = "PC2  (8.86 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.513")), font = 2, col = "black"))
mtext("Jejunum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT3Ileum = read.table("D:/HAUPT3_Updated/Ileum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa15.axes", header=TRUE, sep="\t")
ThetaYCHAUPT3Ileum = ThetaYCHAUPT3Ileum[,-which(names(ThetaYCHAUPT3Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
ThetaYCHAUPT3Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT3Ileum <- ThetaYCHAUPT3Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT3Ileum$axis1, ThetaYCHAUPT3Ileum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT3Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (51.30 %)",
      ylab = "PC2  (20.99 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.085")), font = 2, col = "black"))
mtext("Ileum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT3Caecum = read.table("D:/HAUPT3_Updated/Caecum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa16.axes", header=TRUE, sep="\t")
ThetaYCHAUPT3Caecum = ThetaYCHAUPT3Caecum[,-which(names(ThetaYCHAUPT3Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT3Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT3Caecum <- ThetaYCHAUPT3Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT3Caecum$axis1, ThetaYCHAUPT3Caecum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT3Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (33.15 %)",
      ylab = "PC2  (21.89 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.494")), font = 2, col = "black"))
mtext("Caecum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT3Colon = read.table("D:/HAUPT3_Updated/Colon/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa17.axes", header=TRUE, sep="\t")
ThetaYCHAUPT3Colon = ThetaYCHAUPT3Colon[,-which(names(ThetaYCHAUPT3Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT3Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT3Colon <- ThetaYCHAUPT3Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT3Colon$axis1, ThetaYCHAUPT3Colon$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT3Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (28.51 %)",
      ylab = "PC2  (24.34 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.392")), font = 2, col = "black"))
mtext("Colon", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT3Rectum = read.table("D:/HAUPT3_Updated/Rectum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa18.axes", header=TRUE, sep="\t")
ThetaYCHAUPT3Rectum = ThetaYCHAUPT3Rectum[,-which(names(ThetaYCHAUPT3Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT3Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT3Rectum <- ThetaYCHAUPT3Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT3Rectum$axis1, ThetaYCHAUPT3Rectum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT3Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (37.80 %)",
      ylab = "PC2  (27.26 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.3, y = 0.4, label = substitute(paste(italic("P"), " = 0.034")), font = 2, col = "black"))
mtext("Rectum", side=3, adj=0, line=0.6, cex=0.8, font=2)

BrayCurtisHAUPT3Duodenum = read.table("D:/HAUPT3_Updated/Duodenum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa13.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT3Duodenum = BrayCurtisHAUPT3Duodenum[,-which(names(BrayCurtisHAUPT3Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
BrayCurtisHAUPT3Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT3Duodenum <- BrayCurtisHAUPT3Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT3Duodenum$axis1, BrayCurtisHAUPT3Duodenum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT3Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (61.4 %)",
      ylab = "PC2  (16.67 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.456")), font = 2, col = "black"))
mtext("Bray-Curtis Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

BrayCurtisHAUPT3Jejunum = read.table("D:/HAUPT3_Updated/Jejunum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa14.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT3Jejunum = BrayCurtisHAUPT3Jejunum[,-which(names(BrayCurtisHAUPT3Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT3Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT3Jejunum <- BrayCurtisHAUPT3Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT3Jejunum$axis1, BrayCurtisHAUPT3Jejunum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT3Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (56.47 %)",
      ylab = "PC2  (17.45 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.327")), font = 2, col = "black"))

BrayCurtisHAUPT3Ileum = read.table("D:/HAUPT3_Updated/Ileum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa15.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT3Ileum = BrayCurtisHAUPT3Ileum[,-which(names(BrayCurtisHAUPT3Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
BrayCurtisHAUPT3Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT3Ileum <- BrayCurtisHAUPT3Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT3Ileum$axis1, BrayCurtisHAUPT3Ileum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT3Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (39.91 %)",
      ylab = "PC2  (25.57 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.069")), font = 2, col = "black"))

BrayCurtisHAUPT3Caecum = read.table("D:/HAUPT3_Updated/Caecum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa16.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT3Caecum = BrayCurtisHAUPT3Caecum[,-which(names(BrayCurtisHAUPT3Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT3Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT3Caecum <- BrayCurtisHAUPT3Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT3Caecum$axis1, BrayCurtisHAUPT3Caecum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT3Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (31.74 %)",
      ylab = "PC2  (19.64 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.131")), font = 2, col = "black"))

BrayCurtisHAUPT3Colon = read.table("D:/HAUPT3_Updated/Colon/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa17.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT3Colon = BrayCurtisHAUPT3Colon[,-which(names(BrayCurtisHAUPT3Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT3Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT3Colon <- BrayCurtisHAUPT3Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT3Colon$axis1, BrayCurtisHAUPT3Colon$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT3Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (25.93 %)",
      ylab = "PC2  (22.57 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.241")), font = 2, col = "black"))

BrayCurtisHAUPT3Rectum = read.table("D:/HAUPT3_Updated/Rectum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa18.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT3Rectum = BrayCurtisHAUPT3Rectum[,-which(names(BrayCurtisHAUPT3Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT3Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT3Rectum <- BrayCurtisHAUPT3Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT3Rectum$axis1, BrayCurtisHAUPT3Rectum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT3Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (35.45 %)",
      ylab = "PC2  (21.45 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.034")), font = 2, col = "black"))

JaccardHAUPT3Duodenum = read.table("D:/HAUPT3_Updated/Duodenum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa13.axes", header=TRUE, sep="\t")
JaccardHAUPT3Duodenum = JaccardHAUPT3Duodenum[,-which(names(JaccardHAUPT3Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
JaccardHAUPT3Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT3Duodenum <- JaccardHAUPT3Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT3Duodenum$axis1, JaccardHAUPT3Duodenum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT3Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (30.49 %)",
      ylab = "PC2  (17.90 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.456")), font = 2, col = "black"))
mtext("Jaccard Similarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

JaccardHAUPT3Jejunum = read.table("D:/HAUPT3_Updated/Jejunum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa14.axes", header=TRUE, sep="\t")
JaccardHAUPT3Jejunum = JaccardHAUPT3Jejunum[,-which(names(JaccardHAUPT3Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT3Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT3Jejunum <- JaccardHAUPT3Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT3Jejunum$axis1, JaccardHAUPT3Jejunum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT3Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (21.50 %)",
      ylab = "PC2  (18.97 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.017")), font = 2, col = "black"))

JaccardHAUPT3Ileum = read.table("D:/HAUPT3_Updated/Ileum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa15.axes", header=TRUE, sep="\t")
JaccardHAUPT3Ileum = JaccardHAUPT3Ileum[,-which(names(JaccardHAUPT3Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7"))]
JaccardHAUPT3Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT3Ileum <- JaccardHAUPT3Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT3Ileum$axis1, JaccardHAUPT3Ileum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT3Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (30.15 %)",
      ylab = "PC2  (22.70 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.145")), font = 2, col = "black"))

JaccardHAUPT3Caecum = read.table("D:/HAUPT3_Updated/Caecum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa16.axes", header=TRUE, sep="\t")
JaccardHAUPT3Caecum = JaccardHAUPT3Caecum[,-which(names(JaccardHAUPT3Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT3Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT3Caecum <- JaccardHAUPT3Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT3Caecum$axis1, JaccardHAUPT3Caecum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT3Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (25.59 %)",
      ylab = "PC2  (15.55 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.034")), font = 2, col = "black"))

JaccardHAUPT3Colon = read.table("D:/HAUPT3_Updated/Colon/stability.opti_mcc.jclass.0.03.lt.ave.pcoa17.axes", header=TRUE, sep="\t")
JaccardHAUPT3Colon = JaccardHAUPT3Colon[,-which(names(JaccardHAUPT3Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT3Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT3Colon <- JaccardHAUPT3Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT3Colon$axis1, JaccardHAUPT3Colon$axis2,
      col = my_palette3[as.factor(JaccardHAUPT3Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (17.89 %)",
      ylab = "PC2  (16.50 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.34")), font = 2, col = "black"))

JaccardHAUPT3Rectum = read.table("D:/HAUPT3_Updated/Rectum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa18.axes", header=TRUE, sep="\t")
JaccardHAUPT3Rectum = JaccardHAUPT3Rectum[,-which(names(JaccardHAUPT3Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT3Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT3Rectum <- JaccardHAUPT3Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT3Rectum$axis1, JaccardHAUPT3Rectum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT3Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (21.34 %)",
      ylab = "PC2  (17.78 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.034")), font = 2, col = "black"))
dev.off()

#SUPPLEMENTARY FIGURE 3D

tiff("D:/RFigure/Trial4BetaDiversity2.tiff", pointsize=12, width=7200, height=3800, res=400)
par(mfrow = c(3,6))
par(mar = c(6,6,3,2))

ThetaYCHAUPT4Duodenum = read.table("D:/HAUPT4_Updated/Duodenum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa19.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Duodenum = ThetaYCHAUPT4Duodenum[,-which(names(ThetaYCHAUPT4Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT4Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Duodenum <- ThetaYCHAUPT4Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Duodenum$axis1, ThetaYCHAUPT4Duodenum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (36.92 %)",
      ylab = "PC2  (30.74 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.062")), font = 2, col = "black"))
legend("topright", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, col = my_palette3)
mtext("Duodenum", side=3, adj=0, line=0.6, cex=0.8, font=2)
mtext("Yue & Clayton Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

ThetaYCHAUPT4Jejunum = read.table("D:/HAUPT4_Updated/Jejunum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa20.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Jejunum = ThetaYCHAUPT4Jejunum[,-which(names(ThetaYCHAUPT4Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT4Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Jejunum <- ThetaYCHAUPT4Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Jejunum$axis1, ThetaYCHAUPT4Jejunum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (49.13 %)",
      ylab = "PC2  (20.66 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.209")), font = 2, col = "black"))
mtext("Jejunum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT4Ileum = read.table("D:/HAUPT4_Updated/Ileum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa21.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Ileum = ThetaYCHAUPT4Ileum[,-which(names(ThetaYCHAUPT4Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
ThetaYCHAUPT4Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Ileum <- ThetaYCHAUPT4Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Ileum$axis1, ThetaYCHAUPT4Ileum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (36.67%)",
      ylab = "PC2  (24.82 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.185")), font = 2, col = "black"))
mtext("Ileum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT4Caecum = read.table("D:/HAUPT4_Updated/Caecum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa22.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Caecum = ThetaYCHAUPT4Caecum[,-which(names(ThetaYCHAUPT4Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9", "axis10"))]
ThetaYCHAUPT4Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Caecum <- ThetaYCHAUPT4Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Caecum$axis1, ThetaYCHAUPT4Caecum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (45.47 %)",
      ylab = "PC2  (16.80 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.005")), font = 2, col = "black"))
mtext("Caecum", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT4Colon = read.table("D:/HAUPT4_Updated/Colon/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa23.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Colon = ThetaYCHAUPT4Colon[,-which(names(ThetaYCHAUPT4Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9", "axis10"))]
ThetaYCHAUPT4Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Colon <- ThetaYCHAUPT4Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Colon$axis1, ThetaYCHAUPT4Colon$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (40.99 %)",
      ylab = "PC2  (20.72 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.05")), font = 2, col = "black"))
mtext("Colon", side=3, adj=0, line=0.6, cex=0.8, font=2)

ThetaYCHAUPT4Rectum = read.table("D:/HAUPT4_Updated/Rectum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa24.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Rectum = ThetaYCHAUPT4Rectum[,-which(names(ThetaYCHAUPT4Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
ThetaYCHAUPT4Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Rectum <- ThetaYCHAUPT4Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Rectum$axis1, ThetaYCHAUPT4Rectum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (37.98 %)",
      ylab = "PC2  (20.43 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.121")), font = 2, col = "black"))
mtext("Rectum", side=3, adj=0, line=0.6, cex=0.8, font=2)

BrayCurtisHAUPT4Duodenum = read.table("D:/HAUPT4_Updated/Duodenum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa19.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT4Duodenum = BrayCurtisHAUPT4Duodenum[,-which(names(BrayCurtisHAUPT4Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT4Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
BrayCurtisHAUPT4Duodenum <- BrayCurtisHAUPT4Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT4Duodenum$axis1, BrayCurtisHAUPT4Duodenum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT4Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (41.34 %)",
      ylab = "PC2  (22.71 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.001")), font = 2, col = "black"))
mtext("Bray-Curtis Dissimilarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

BrayCurtisHAUPT4Jejunum = read.table("D:/HAUPT4_Updated/Jejunum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa20.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT4Jejunum = BrayCurtisHAUPT4Jejunum[,-which(names(BrayCurtisHAUPT4Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT4Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT4Jejunum <- BrayCurtisHAUPT4Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT4Jejunum$axis1, BrayCurtisHAUPT4Jejunum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT4Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (48.95 %)",
      ylab = "PC2  (18.76 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.252")), font = 2, col = "black"))

BrayCurtisHAUPT4Ileum = read.table("D:/HAUPT4_Updated/Ileum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa21.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT4Ileum = BrayCurtisHAUPT4Ileum[,-which(names(BrayCurtisHAUPT4Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
BrayCurtisHAUPT4Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT4Ileum <- BrayCurtisHAUPT4Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT4Ileum$axis1, BrayCurtisHAUPT4Ileum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT4Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (31.88 %)",
      ylab = "PC2  (23.94 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.257")), font = 2, col = "black"))

ThetaYCHAUPT4Caecum = read.table("D:/HAUPT4_Updated/Caecum/stability.opti_mcc.thetayc.0.03.lt.ave.pcoa22.axes", header=TRUE, sep="\t")
ThetaYCHAUPT4Caecum = ThetaYCHAUPT4Caecum[,-which(names(ThetaYCHAUPT4Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9", "axis10"))]
ThetaYCHAUPT4Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
ThetaYCHAUPT4Caecum <- ThetaYCHAUPT4Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(ThetaYCHAUPT4Caecum$axis1, ThetaYCHAUPT4Caecum$axis2,
      col = my_palette3[as.factor(ThetaYCHAUPT4Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (40.57 %)",
      ylab = "PC2  (15.94 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.004")), font = 2, col = "black"))

BrayCurtisHAUPT4Colon = read.table("D:/HAUPT4_Updated/Colon/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa23.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT4Colon = BrayCurtisHAUPT4Colon[,-which(names(BrayCurtisHAUPT4Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9", "axis10"))]
BrayCurtisHAUPT4Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT4Colon <- BrayCurtisHAUPT4Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT4Colon$axis1, BrayCurtisHAUPT4Colon$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT4Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (35.20 %)",
      ylab = "PC2  (21.50 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.01")), font = 2, col = "black"))

BrayCurtisHAUPT4Rectum = read.table("D:/HAUPT4_Updated/Rectum/stability.opti_mcc.braycurtis.0.03.lt.ave.pcoa24.axes", header=TRUE, sep="\t")
BrayCurtisHAUPT4Rectum = BrayCurtisHAUPT4Rectum[,-which(names(BrayCurtisHAUPT4Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
BrayCurtisHAUPT4Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
BrayCurtisHAUPT4Rectum <- BrayCurtisHAUPT4Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(BrayCurtisHAUPT4Rectum$axis1, BrayCurtisHAUPT4Rectum$axis2,
      col = my_palette3[as.factor(BrayCurtisHAUPT4Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (35.43 %)",
      ylab = "PC2  (18.91 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.061")), font = 2, col = "black"))

JaccardHAUPT4Duodenum = read.table("D:/HAUPT4_Updated/Duodenum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa19.axes", header=TRUE, sep="\t")
JaccardHAUPT4Duodenum = JaccardHAUPT4Duodenum[,-which(names(JaccardHAUPT4Duodenum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT4Duodenum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS")
JaccardHAUPT4Duodenum <- JaccardHAUPT4Duodenum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT4Duodenum$axis1, JaccardHAUPT4Duodenum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT4Duodenum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (21.90 %)",
      ylab = "PC2  (18.36 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.018")), font = 2, col = "black"))
mtext("Jaccard Similarity", side=3, adj=0, line=1.7, cex=0.8, font=2)

JaccardHAUPT4Jejunum = read.table("D:/HAUPT4_Updated/Jejunum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa20.axes", header=TRUE, sep="\t")
JaccardHAUPT4Jejunum = JaccardHAUPT4Jejunum[,-which(names(JaccardHAUPT4Jejunum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT4Jejunum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT4Jejunum <- JaccardHAUPT4Jejunum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT4Jejunum$axis1, JaccardHAUPT4Jejunum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT4Jejunum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (22.02 %)",
      ylab = "PC2  (14.42 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.006")), font = 2, col = "black"))

JaccardHAUPT4Ileum = read.table("D:/HAUPT4_Updated/Ileum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa21.axes", header=TRUE, sep="\t")
JaccardHAUPT4Ileum = JaccardHAUPT4Ileum[,-which(names(JaccardHAUPT4Ileum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8"))]
JaccardHAUPT4Ileum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT4Ileum <- JaccardHAUPT4Ileum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT4Ileum$axis1, JaccardHAUPT4Ileum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT4Ileum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (26.55 %)",
      ylab = "PC2  (15.96 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.173")), font = 2, col = "black"))

JaccardHAUPT4Caecum = read.table("D:/HAUPT4_Updated/Caecum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa22.axes", header=TRUE, sep="\t")
JaccardHAUPT4Caecum = JaccardHAUPT4Caecum[,-which(names(JaccardHAUPT4Caecum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9", "axis10"))]
JaccardHAUPT4Caecum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT4Caecum <- JaccardHAUPT4Caecum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT4Caecum$axis1, JaccardHAUPT4Caecum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT4Caecum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (28.24 %)",
      ylab = "PC2  (14.25 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.005")), font = 2, col = "black"))

JaccardHAUPT4Colon = read.table("D:/HAUPT4_Updated/Colon/stability.opti_mcc.jclass.0.03.lt.ave.pcoa23.axes", header=TRUE, sep="\t")
JaccardHAUPT4Colon = JaccardHAUPT4Colon[,-which(names(JaccardHAUPT4Colon) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9", "axis10"))]
JaccardHAUPT4Colon$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT4Colon <- JaccardHAUPT4Colon[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT4Colon$axis1, JaccardHAUPT4Colon$axis2,
      col = my_palette3[as.factor(JaccardHAUPT4Colon$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (25.41 %)",
      ylab = "PC2  (16.69 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.005")), font = 2, col = "black"))

JaccardHAUPT4Rectum = read.table("D:/HAUPT4_Updated/Rectum/stability.opti_mcc.jclass.0.03.lt.ave.pcoa24.axes", header=TRUE, sep="\t")
JaccardHAUPT4Rectum = JaccardHAUPT4Rectum[,-which(names(JaccardHAUPT4Rectum) %in% c("axis3", "axis4", "axis5", "axis6", "axis7", "axis8", "axis9"))]
JaccardHAUPT4Rectum$Group <-  c("CONTROL", "CONTROL", "CONTROL", "CONTROL", "CONTROL", "GOS", "GOS", "GOS", "GOS")
JaccardHAUPT4Rectum <- JaccardHAUPT4Rectum[ -c(1)]
my_palette3 <- c("#7570B3", "#E7298A")
plot(JaccardHAUPT4Rectum$axis1, JaccardHAUPT4Rectum$axis2,
      col = my_palette3[as.factor(JaccardHAUPT4Rectum$Group)],
      xlim = c(-0.6, 0.6),
      ylim = c(-0.6, 0.6),
      cex = 3,
      cex.lab = 1,
      cex.axis = 1,
      pch = 20,
      xlab = "PC1 (28.69 %)",
      ylab = "PC2  (18.48 %)",
      font.lab = 2,
      font = 2,
      text(x = -0.4, y = 0.4, label = substitute(paste(italic("P"), " = 0.012")), font = 2, col = "black"))
dev.off()



SUPPLEMENTARY FIGURE 4A#

set.seed(3711)
library(dplyr)
library(openxlsx)
options(scipen=1000)
tiff('F:/RFigure/LEFSETrial1.tiff', pointsize=10, width=2600, height=2600, res=300)
LEFSEDuodenum = read.table("D:/HAUPT1_Updated/Duodenum/stability.opti_mcc.0.03.subsample.0.031.lefse_summary", header=TRUE, sep="\t")
LEFSEDuodenum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT1_Updated/Duodenum/Results/Relative Abundance Duodenum1.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSEDuodenum <- LEFSEDuodenum %>% slice(1:nrow)
LEFSEDuodenum <-cbind(LEFSEDuodenum, RelativeAbundance)
LEFSEDuodenum <- na.omit(LEFSEDuodenum)
LEFSEDuodenum$Class = ifelse(LEFSEDuodenum$CONTROL < LEFSEDuodenum$GOS,"GOS","CONTROL")
LEFSEDuodenum$pValue <- round(LEFSEDuodenum$pValue, digits = 3)
LEFSEDuodenum$significance <- ifelse(LEFSEDuodenum$pValue < "0.001", "****",
                      		ifelse(LEFSEDuodenum$pValue < "0.01", "***",
                      		ifelse(LEFSEDuodenum$pValue < "0.025", "**",
                      		ifelse(LEFSEDuodenum$pValue <= "0.05", "*"))))
LEFSEDuodenum$Names = paste(LEFSEDuodenum$OTU, LEFSEDuodenum$Genus, LEFSEDuodenum$significance)
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(Class))

LEFSEJejunum = read.table("D:/HAUPT1_Updated/Jejunum/stability.opti_mcc.0.03.subsample.0.032.lefse_summary", header=TRUE, sep="\t")
LEFSEJejunum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT1_Updated/Jejunum/Results/Relative Abundance Jejunum1.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSEJejunum <- LEFSEJejunum %>% slice(1:nrow)
LEFSEJejunum <-cbind(LEFSEJejunum, RelativeAbundance)
LEFSEJejunum <- na.omit(LEFSEJejunum)
LEFSEJejunum$Class = ifelse(LEFSEJejunum$CONTROL < LEFSEJejunum$GOS,"GOS","CONTROL")
LEFSEJejunum$pValue <- round(LEFSEJejunum$pValue, digits = 3)
LEFSEJejunum$significance <- ifelse(LEFSEJejunum$pValue < "0.001", "****",
                      		ifelse(LEFSEJejunum$pValue < "0.01", "***",
                      		ifelse(LEFSEJejunum$pValue < "0.025", "**",
                      		ifelse(LEFSEJejunum$pValue <= "0.05", "*"))))
LEFSEJejunum$Names = paste(LEFSEJejunum$OTU, LEFSEJejunum$Genus, LEFSEJejunum$significance)
LEFSEJejunum$Names [4] <- "Otu022 Pasteurellaceae UC *"
LEFSEJejunum <- arrange(LEFSEJejunum, desc(Class))

LEFSEIleum = read.table("D:/HAUPT1_Updated/Ileum/stability.opti_mcc.0.03.subsample.0.033.lefse_summary", header=TRUE, sep="\t")
LEFSEIleum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT1_Updated/Ileum/Results/Relative Abundance Ileum1.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSEIleum <- LEFSEIleum %>% slice(1:nrow)
LEFSEIleum <-cbind(LEFSEIleum, RelativeAbundance)
LEFSEIleum <- na.omit(LEFSEIleum)
LEFSEIleum$Class = ifelse(LEFSEIleum$CONTROL < LEFSEIleum$GOS,"GOS","CONTROL")
LEFSEIleum$pValue <- round(LEFSEIleum$pValue, digits = 3)
LEFSEIleum$significance <- ifelse(LEFSEIleum$pValue < "0.001", "****",
                      		ifelse(LEFSEIleum$pValue < "0.01", "***",
                      		ifelse(LEFSEIleum$pValue < "0.025", "**",
                      		ifelse(LEFSEIleum$pValue <= "0.05", "*"))))
LEFSEIleum$Names = paste(LEFSEIleum$OTU, LEFSEIleum$Genus, LEFSEIleum$significance)
LEFSEIleum <- LEFSEIleum %>% slice(1:10)
LEFSEIleum <- arrange(LEFSEIleum, desc(Class))

LEFSECaecum = read.table("D:/HAUPT1_Updated/Caecum/stability.opti_mcc.0.03.subsample.0.034.lefse_summary", header=TRUE, sep="\t")
LEFSECaecum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT1_Updated/Caecum/Results/Relative Abundance Caecum1.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSECaecum <- LEFSECaecum %>% slice(1:nrow)
LEFSECaecum <-cbind(LEFSECaecum, RelativeAbundance)
LEFSECaecum <- na.omit(LEFSECaecum)
LEFSECaecum$Class = ifelse(LEFSECaecum$CONTROL < LEFSECaecum$GOS,"GOS","CONTROL")
LEFSECaecum$pValue <- round(LEFSECaecum$pValue, digits = 3)
LEFSECaecum$significance <- ifelse(LEFSECaecum$pValue < "0.001", "****",
                      		ifelse(LEFSECaecum$pValue < "0.01", "***",
                      		ifelse(LEFSECaecum$pValue < "0.025", "**",
                      		ifelse(LEFSECaecum$pValue <= "0.05", "*"))))
LEFSECaecum$Names = paste(LEFSECaecum$OTU, LEFSECaecum$Genus, LEFSECaecum$significance)
LEFSECaecum$Names [7] <- "Otu085 Clostridiales UC *"
LEFSECaecum$Names [8] <- "Otu091 Bacteroidales UC *"
LEFSECaecum <- arrange(LEFSECaecum, desc(Class))

LEFSEColon = read.table("D:/HAUPT1_Updated/Colon/stability.opti_mcc.0.03.subsample.0.035.lefse_summary", header=TRUE, sep="\t")
LEFSEColon$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT1_Updated/Colon/Results/Relative Abundance Colon1.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSEColon <- LEFSEColon %>% slice(1:nrow)
LEFSEColon <-cbind(LEFSEColon, RelativeAbundance)
LEFSEColon <- na.omit(LEFSEColon)
LEFSEColon$Class = ifelse(LEFSEColon$CONTROL < LEFSEColon$GOS,"GOS","CONTROL")
LEFSEColon$pValue <- round(LEFSEColon$pValue, digits = 3)
LEFSEColon$significance <- ifelse(LEFSEColon$pValue < "0.001", "****",
                      		ifelse(LEFSEColon$pValue < "0.01", "***",
                      		ifelse(LEFSEColon$pValue < "0.025", "**",
                      		ifelse(LEFSEColon$pValue <= "0.05", "*"))))
LEFSEColon$Names = paste(LEFSEColon$OTU, LEFSEColon$Genus, LEFSEColon$significance)
LEFSEColon$Names [7] <- "Otu073 Clostridiales UC *"
LEFSEColon$Names [8] <- "Otu091 Clostridiales UC *"
LEFSEColon <- arrange(LEFSEColon, desc(Class))

LEFSERectum = read.table("D:/HAUPT1_Updated/Rectum/stability.opti_mcc.0.03.subsample.0.036.lefse_summary", header=TRUE, sep="\t")
LEFSERectum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT1_Updated/Rectum/Results/Relative Abundance Rectum1.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSERectum <- LEFSERectum %>% slice(1:nrow)
LEFSERectum <-cbind(LEFSERectum, RelativeAbundance)
LEFSERectum <- na.omit(LEFSERectum)
LEFSERectum$Class = ifelse(LEFSERectum$CONTROL < LEFSERectum$GOS,"GOS","CONTROL")
LEFSERectum$pValue <- round(LEFSERectum$pValue, digits = 3)
LEFSERectum$significance <- ifelse(LEFSERectum$pValue < "0.001", "****",
                      		ifelse(LEFSERectum$pValue < "0.01", "***",
                      		ifelse(LEFSERectum$pValue < "0.025", "**",
                      		ifelse(LEFSERectum$pValue <= "0.05", "*"))))
LEFSERectum$Names = paste(LEFSERectum$OTU, LEFSERectum$Genus, LEFSERectum$significance)
LEFSERectum <- LEFSERectum %>% slice(1:10)
LEFSERectum$Names [4] <- "Otu024 Firmicutes UC *"
LEFSERectum$Names [6] <- "Otu043 Ruminococcaceae UC *"
LEFSERectum$Names [8] <- "Otu065 Clostridiales UC *"
LEFSERectum <- arrange(LEFSERectum, desc(Class))

LEFSETRIAL1 <- rbind(LEFSEDuodenum, LEFSEJejunum, LEFSEIleum, LEFSECaecum, LEFSEColon, LEFSERectum)
LEFSETRIAL1Graph <- select(LEFSETRIAL1, Names, LDA, Class)
my_palette3 <- c("#7570B3", "#E7298A")

par(mar = c(4, 16, 4, 0.5))
barplot(LEFSETRIAL1Graph$LDA,
         horiz = TRUE,
         col = my_palette3[as.factor(LEFSETRIAL1Graph$Class)],
         xlim = c(0, 5),
         xlab ="LDA Score log 10",
         font.lab = 2,
         font = 2,
         names.arg = LEFSETRIAL1Graph$Names,
	 las = 1,
         cex.names = 0.9,
         cex.lab = 1.0)
abline(h=0.1, lwd = 2)
abline(h=9.69, lwd = 2)
abline(h=16.88, lwd = 2)
abline(h=28.9, lwd = 2)
abline(h=38.5, lwd = 2)
abline(h=48.1, lwd = 2)
abline(h=60, lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, h = TRUE, pch = 15, text.font = 2, col = c("#7570B3", "#E7298A"))
mtext("Trial 1", side=3, adj=-0.25, line=0.5, cex=1.2, font=2, font.lab = 2)
text(x = 4.7, y = 8, label ="Duodenum", cex = 1, font = 2)
text(x = 4.7, y = 15, label ="Jejunum", cex = 1, font = 2)
text(x = 4.7, y = 27, label ="Ileum", cex = 1, font = 2)
text(x = 4.7, y = 37, label ="Caecum", cex = 1, font = 2)
text(x = 4.7, y = 46.5, label ="Colon", cex = 1, font = 2)
text(x = 4.7, y = 58, label ="Rectum", cex = 1, font = 2)
text(2.5, 61, label = substitute(paste(italic("*P"), " = 0.05")), font = 2, col = "black")
text(3.5, 61, label = substitute(paste(italic("**P"), " = 0.025")), font = 2, col = "black")
text(4.5, 61, label = substitute(paste(italic("***P"), " = 0.01")), font = 2, col = "black")
dev.off()

#SUPPLEMENTARY FIGURE 4B

set.seed(3711)
library(dplyr)
library(openxlsx)
options(scipen=1000)
tiff('F:/RFigure/LEFSETrial2.tiff', pointsize=10, width=2600, height=2600, res=300)
LEFSEDuodenum = read.table("D:/HAUPT2_Updated/Duodenum/stability.opti_mcc.0.03.subsample.0.037.lefse_summary", header=TRUE, sep="\t")
LEFSEDuodenum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT2_Updated/Duodenum/Results/Relative Abundance Duodenum2.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEDuodenum <- LEFSEDuodenum %>% slice(1:nrow)
LEFSEDuodenum <-cbind(LEFSEDuodenum, RelativeAbundance)
LEFSEDuodenum <- na.omit(LEFSEDuodenum)
LEFSEDuodenum$Class = ifelse(LEFSEDuodenum$CONTROL < LEFSEDuodenum$GOS,"GOS","CONTROL")
LEFSEDuodenum$pValue <- round(LEFSEDuodenum$pValue, digits = 3)
LEFSEDuodenum$significance <- ifelse(LEFSEDuodenum$pValue < "0.001", "****",
                      		ifelse(LEFSEDuodenum$pValue < "0.01", "***",
                      		ifelse(LEFSEDuodenum$pValue < "0.025", "**",
                      		ifelse(LEFSEDuodenum$pValue <= "0.05", "*"))))
LEFSEDuodenum$Names = paste(LEFSEDuodenum$OTU, LEFSEDuodenum$Genus, LEFSEDuodenum$significance)
LEFSEDuodenum$Names [7] <- "Otu029 Clostridium sensu stricto *"
LEFSEDuodenum <- LEFSEDuodenum %>% slice(1:10)
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(LDA))
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(Class))


LEFSEJejunum = read.table("D:/HAUPT2_Updated/Jejunum/stability.opti_mcc.0.03.subsample.0.038.lefse_summary", header=TRUE, sep="\t")
LEFSEJejunum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT2_Updated/Jejunum/Results/Relative Abundance Jejunum2.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEJejunum <- LEFSEJejunum %>% slice(1:nrow)
LEFSEJejunum <-cbind(LEFSEJejunum, RelativeAbundance)
LEFSEJejunum <- na.omit(LEFSEJejunum)
LEFSEJejunum$Class = ifelse(LEFSEJejunum$CONTROL < LEFSEJejunum$GOS,"GOS","CONTROL")
LEFSEJejunum$pValue <- round(LEFSEJejunum$pValue, digits = 3)
LEFSEJejunum$significance <- ifelse(LEFSEJejunum$pValue < "0.001", "****",
                      		ifelse(LEFSEJejunum$pValue < "0.01", "***",
                      		ifelse(LEFSEJejunum$pValue < "0.025", "**",
                      		ifelse(LEFSEJejunum$pValue <= "0.05", "*"))))
LEFSEJejunum$Names = paste(LEFSEJejunum$OTU, LEFSEJejunum$Genus, LEFSEJejunum$significance)
LEFSEJejunum <- LEFSEJejunum %>% slice(1:10)
LEFSEJejunum$Names [3] <- "Otu006 Pasteurellaceae UC *"
LEFSEJejunum$Names [9] <- "Otu031 Enterobacteriaceae UC *"
LEFSEJejunum <- arrange(LEFSEJejunum, desc(LDA))
LEFSEJejunum <- arrange(LEFSEJejunum, desc(Class))


LEFSEIleum = read.table("D:/HAUPT2_Updated/Ileum/stability.opti_mcc.0.03.subsample.0.039.lefse_summary", header=TRUE, sep="\t")
LEFSEIleum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT2_Updated/Ileum/Results/Relative Abundance Ileum2.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEIleum <- LEFSEIleum %>% slice(1:nrow)
LEFSEIleum <-cbind(LEFSEIleum, RelativeAbundance)
LEFSEIleum <- na.omit(LEFSEIleum)
LEFSEIleum$Class = ifelse(LEFSEIleum$CONTROL < LEFSEIleum$GOS,"GOS","CONTROL")
LEFSEIleum$pValue <- round(LEFSEIleum$pValue, digits = 3)
LEFSEIleum$significance <- ifelse(LEFSEIleum$pValue < "0.001", "****",
                      		ifelse(LEFSEIleum$pValue < "0.01", "***",
                      		ifelse(LEFSEIleum$pValue < "0.025", "**",
                      		ifelse(LEFSEIleum$pValue <= "0.05", "*"))))
LEFSEIleum$Names = paste(LEFSEIleum$OTU, LEFSEIleum$Genus, LEFSEIleum$significance)
LEFSEIleum <- LEFSEIleum %>% slice(1:10)
LEFSEIleum$Names [8] <- "Otu045 Pasteurellaceae UC **"
LEFSEIleum <- arrange(LEFSEIleum, desc(LDA))
LEFSEIleum <- arrange(LEFSEIleum, desc(Class))



LEFSECaecum = read.table("D:/HAUPT2_Updated/Caecum/stability.opti_mcc.0.03.subsample.0.0310.lefse_summary", header=TRUE, sep="\t")
LEFSECaecum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT2_Updated/Caecum/Results/Relative Abundance Caecum2.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSECaecum <- LEFSECaecum %>% slice(1:nrow)
LEFSECaecum <-cbind(LEFSECaecum, RelativeAbundance)
LEFSECaecum <- na.omit(LEFSECaecum)
LEFSECaecum$Class = ifelse(LEFSECaecum$CONTROL < LEFSECaecum$GOS,"GOS","CONTROL")
LEFSECaecum$pValue <- round(LEFSECaecum$pValue, digits = 3)
LEFSECaecum$significance <- ifelse(LEFSECaecum$pValue < "0.001", "****",
                      		ifelse(LEFSECaecum$pValue < "0.01", "***",
                      		ifelse(LEFSECaecum$pValue < "0.025", "**",
                      		ifelse(LEFSECaecum$pValue <= "0.05", "*"))))
LEFSECaecum$Names = paste(LEFSECaecum$OTU, LEFSECaecum$Genus, LEFSECaecum$significance)
LEFSECaecum <- LEFSECaecum %>% slice(1:10)
LEFSECaecum <- arrange(LEFSECaecum, desc(LDA))
LEFSECaecum <- arrange(LEFSECaecum, desc(Class))


LEFSEColon = read.table("D:/HAUPT2_Updated/Colon/stability.opti_mcc.0.03.subsample.0.0311.lefse_summary", header=TRUE, sep="\t")
LEFSEColon$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT2_Updated/Colon/Results/Relative Abundance Colon2.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEColon <- LEFSEColon %>% slice(1:nrow)
LEFSEColon <-cbind(LEFSEColon, RelativeAbundance)
LEFSEColon <- na.omit(LEFSEColon)
LEFSEColon$Class = ifelse(LEFSEColon$CONTROL < LEFSEColon$GOS,"GOS","CONTROL")
LEFSEColon$pValue <- round(LEFSEColon$pValue, digits = 3)
LEFSEColon$significance <- ifelse(LEFSEColon$pValue < "0.001", "****",
                      		ifelse(LEFSEColon$pValue < "0.01", "***",
                      		ifelse(LEFSEColon$pValue < "0.025", "**",
                      		ifelse(LEFSEColon$pValue <= "0.05", "*"))))
LEFSEColon$Names = paste(LEFSEColon$OTU, LEFSEColon$Genus, LEFSEColon$significance)
LEFSEColon <- LEFSEColon %>% slice(1:10)
LEFSEColon$Names [10] <- "Otu091 Ruminococcaceae UC *"
LEFSEColon <- arrange(LEFSEColon, desc(LDA))
LEFSEColon <- arrange(LEFSEColon, desc(Class))


LEFSERectum = read.table("D:/HAUPT2_Updated/Rectum/stability.opti_mcc.0.03.subsample.0.0312.lefse_summary", header=TRUE, sep="\t")
LEFSERectum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT2_Updated/Rectum/Results/Relative Abundance Rectum2.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.1, ]
nrow <- nrow(RelativeAbundance)
LEFSERectum <- LEFSERectum %>% slice(1:nrow)
LEFSERectum <-cbind(LEFSERectum, RelativeAbundance)
LEFSERectum <- na.omit(LEFSERectum)
LEFSERectum$Class = ifelse(LEFSERectum$CONTROL < LEFSERectum$GOS,"GOS","CONTROL")
LEFSERectum$pValue <- round(LEFSERectum$pValue, digits = 3)
LEFSERectum$significance <- ifelse(LEFSERectum$pValue < "0.001", "****",
                      		ifelse(LEFSERectum$pValue < "0.01", "***",
                      		ifelse(LEFSERectum$pValue < "0.025", "**",
                      		ifelse(LEFSERectum$pValue <= "0.05", "*"))))
LEFSERectum$Names = paste(LEFSERectum$OTU, LEFSERectum$Genus, LEFSERectum$significance)
LEFSERectum <- LEFSERectum %>% slice(1:10)
LEFSERectum$Names [10] <- "Otu058 Porphyromonadaceae UC **"
LEFSERectum <- arrange(LEFSERectum, desc(LDA))
LEFSERectum <- arrange(LEFSERectum, desc(Class))

LEFSETrial2 <- rbind(LEFSEDuodenum, LEFSEJejunum, LEFSEIleum, LEFSECaecum, LEFSEColon, LEFSERectum)
LEFSETrial2Graph <- select(LEFSETrial2, Names, LDA, Class)
my_palette3 <- c("#7570B3", "#E7298A")

par(mar = c(4, 16, 4, 0.5))
barplot(LEFSETrial2Graph$LDA,
         horiz = TRUE,
         col = my_palette3[as.factor(LEFSETrial2Graph$Class)],
         xlim = c(0, 6),
         xlab ="LDA Score log 10",
         font.lab = 2,
         font = 2,
         names.arg = LEFSETrial2Graph$Names,
	 las = 1,
         cex.names = 0.8,
         cex.lab = 1.0)
abline(h=0.1, lwd = 2)
abline(h=12, lwd = 2)
abline(h=24.1, lwd = 2)
abline(h=36.1, lwd = 2)
abline(h=48.1, lwd = 2)
abline(h=60, lwd = 2)
abline(h=72.1, lwd = 2)
legend(x = 0, y = 76, c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1.2, h = TRUE, pch = 15, text.font = 2, col = c("#7570B3", "#E7298A"))
mtext("Trial 2", side=3, adj=-0.25, line=0, cex=1.2, font=2, font.lab = 2)
text(x = 5.5, y = 10, label ="Duodenum", cex = 1, font = 2)
text(x = 5.5, y = 22, label ="Jejunum", cex = 1, font = 2)
text(x = 5.5, y = 33, label ="Ileum", cex = 1, font = 2)
text(x = 5.5, y = 45.5, label ="Caecum", cex = 1, font = 2)
text(x = 5.5, y = 57.5, label ="Colon", cex = 1, font = 2)
text(x = 5.5, y = 69.5, label ="Rectum", cex = 1, font = 2)
text(3.5, 74, label = substitute(paste(italic("*P"), " = 0.05")), font = 2, col = "black")
text(4.5, 74, label = substitute(paste(italic("**P"), " = 0.025")), font = 2, col = "black")
text(5.5, 74, label = substitute(paste(italic("***P"), " = 0.01")), font = 2, col = "black")
dev.off()

SUPPLEMENTARY FIGURE 4C

set.seed(3711)
library(dplyr)
library(openxlsx)
options(scipen=1000)
tiff('F:/RFigure/LEFSETrial3.tiff', pointsize=10, width=2600, height=2600, res=300)
LEFSEDuodenum = read.table("D:/HAUPT3_Updated/Duodenum/stability.opti_mcc.0.03.subsample.0.0313.lefse_summary", header=TRUE, sep="\t")
LEFSEDuodenum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT3_Updated/Duodenum/Results/Relative Abundance Duodenum3.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEDuodenum <- LEFSEDuodenum %>% slice(1:nrow)
LEFSEDuodenum <-cbind(LEFSEDuodenum, RelativeAbundance)
LEFSEDuodenum <- na.omit(LEFSEDuodenum)
LEFSEDuodenum$Class = ifelse(LEFSEDuodenum$CONTROL < LEFSEDuodenum$GOS,"GOS","CONTROL")
LEFSEDuodenum$pValue <- round(LEFSEDuodenum$pValue, digits = 3)
LEFSEDuodenum$significance <- ifelse(LEFSEDuodenum$pValue < "0.001", "****",
                      		ifelse(LEFSEDuodenum$pValue < "0.01", "***",
                      		ifelse(LEFSEDuodenum$pValue < "0.025", "**",
                      		ifelse(LEFSEDuodenum$pValue <= "0.05", "*"))))
LEFSEDuodenum$Names = paste(LEFSEDuodenum$OTU, LEFSEDuodenum$Genus, LEFSEDuodenum$significance)
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(LDA))
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(Class))


LEFSEJejunum = read.table("D:/HAUPT3_Updated/Jejunum/stability.opti_mcc.0.03.subsample.0.0314.lefse_summary", header=TRUE, sep="\t")
LEFSEJejunum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT3_Updated/Jejunum/Results/Relative Abundance Jejunum3.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEJejunum <- LEFSEJejunum %>% slice(1:nrow)
LEFSEJejunum <-cbind(LEFSEJejunum, RelativeAbundance)
LEFSEJejunum <- na.omit(LEFSEJejunum)
LEFSEJejunum$Class = ifelse(LEFSEJejunum$CONTROL < LEFSEJejunum$GOS,"GOS","CONTROL")
LEFSEJejunum$pValue <- round(LEFSEJejunum$pValue, digits = 3)
LEFSEJejunum$significance <- ifelse(LEFSEJejunum$pValue < "0.001", "****",
                      		ifelse(LEFSEJejunum$pValue < "0.01", "***",
                      		ifelse(LEFSEJejunum$pValue < "0.025", "**",
                      		ifelse(LEFSEJejunum$pValue <= "0.05", "*"))))
LEFSEJejunum$Names = paste(LEFSEJejunum$OTU, LEFSEJejunum$Genus, LEFSEJejunum$significance)
LEFSEJejunum <- arrange(LEFSEJejunum, desc(LDA))
LEFSEJejunum <- arrange(LEFSEJejunum, desc(Class))


LEFSEIleum = read.table("D:/HAUPT3_Updated/Ileum/stability.opti_mcc.0.03.subsample.0.0315.lefse_summary", header=TRUE, sep="\t")
LEFSEIleum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT3_Updated/Ileum/Results/Relative Abundance Ileum3.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEIleum <- LEFSEIleum %>% slice(1:nrow)
LEFSEIleum <-cbind(LEFSEIleum, RelativeAbundance)
LEFSEIleum <- na.omit(LEFSEIleum)
LEFSEIleum$Class = ifelse(LEFSEIleum$CONTROL < LEFSEIleum$GOS,"GOS","CONTROL")
LEFSEIleum$pValue <- round(LEFSEIleum$pValue, digits = 3)
LEFSEIleum$significance <- ifelse(LEFSEIleum$pValue < "0.001", "****",
                      		ifelse(LEFSEIleum$pValue < "0.01", "***",
                      		ifelse(LEFSEIleum$pValue < "0.025", "**",
                      		ifelse(LEFSEIleum$pValue <= "0.05", "*"))))
LEFSEIleum$Names = paste(LEFSEIleum$OTU, LEFSEIleum$Genus, LEFSEIleum$significance)
LEFSEIleum$Names [4] <- "Otu039 Clostridium sensu stricto *"
LEFSEIleum <- arrange(LEFSEIleum, desc(LDA))
LEFSEIleum <- arrange(LEFSEIleum, desc(Class))


LEFSECaecum = read.table("D:/HAUPT3_Updated/Caecum/stability.opti_mcc.0.03.subsample.0.0316.lefse_summary", header=TRUE, sep="\t")
LEFSECaecum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT3_Updated/Caecum/Results/Relative Abundance Caecum3.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSECaecum <- LEFSECaecum %>% slice(1:nrow)
LEFSECaecum <-cbind(LEFSECaecum, RelativeAbundance)
LEFSECaecum <- na.omit(LEFSECaecum)
LEFSECaecum$Class = ifelse(LEFSECaecum$CONTROL < LEFSECaecum$GOS,"GOS","CONTROL")
LEFSECaecum$pValue <- round(LEFSECaecum$pValue, digits = 3)
LEFSECaecum$significance <- ifelse(LEFSECaecum$pValue < "0.001", "****",
                      		ifelse(LEFSECaecum$pValue < "0.01", "***",
                      		ifelse(LEFSECaecum$pValue < "0.025", "**",
                      		ifelse(LEFSECaecum$pValue <= "0.05", "*"))))
LEFSECaecum$Names = paste(LEFSECaecum$OTU, LEFSECaecum$Genus, LEFSECaecum$significance)
LEFSECaecum <- LEFSECaecum %>% slice(1:10)
LEFSECaecum$Names [2] <- "Otu020 Veillonellaceae UC **"
LEFSECaecum$Names [3] <- "Otu025 Bacteroidetes UC *"
LEFSECaecum$Names [7] <- "Otu044 Clostridiales UC **"
LEFSECaecum$Names [8] <- "Otu050 Prevotellaceae UC *"
LEFSECaecum <- arrange(LEFSECaecum, desc(LDA))
LEFSECaecum <- arrange(LEFSECaecum, desc(Class))

LEFSEColon = read.table("D:/HAUPT3_Updated/Colon/stability.opti_mcc.0.03.subsample.0.0317.lefse_summary", header=TRUE, sep="\t")
LEFSEColon$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT3_Updated/Colon/Results/Relative Abundance Colon3.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEColon <- LEFSEColon %>% slice(1:nrow)
LEFSEColon <-cbind(LEFSEColon, RelativeAbundance)
LEFSEColon <- na.omit(LEFSEColon)
LEFSEColon$Class = ifelse(LEFSEColon$CONTROL < LEFSEColon$GOS,"GOS","CONTROL")
LEFSEColon$pValue <- round(LEFSEColon$pValue, digits = 3)
LEFSEColon$significance <- ifelse(LEFSEColon$pValue < "0.001", "****",
                      		ifelse(LEFSEColon$pValue < "0.01", "***",
                      		ifelse(LEFSEColon$pValue < "0.025", "**",
                      		ifelse(LEFSEColon$pValue <= "0.05", "*"))))
LEFSEColon$Names = paste(LEFSEColon$OTU, LEFSEColon$Genus, LEFSEColon$significance)
LEFSEColon <- LEFSEColon %>% slice(1:10)
LEFSEColon$Names [1] <- "Otu006 Ruminococcaceae UC **"
LEFSEColon$Names [2] <- "Otu016 Xanthomonadaceae UC **"
LEFSEColon$Names [3] <- "Otu021 Clostridium III *"
LEFSEColon$Names [5] <- "Otu024 Clostridiales UC *"
LEFSEColon$Names [7] <- "Otu055 Ruminococcaceae UC *"
LEFSEColon$Names [9] <- "Otu074 Bacteria UC *"
LEFSEColon <- arrange(LEFSEColon, desc(LDA))
LEFSEColon <- arrange(LEFSEColon, desc(Class))

LEFSERectum = read.table("D:/HAUPT3_Updated/Rectum/stability.opti_mcc.0.03.subsample.0.0318.lefse_summary", header=TRUE, sep="\t")
LEFSERectum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT3_Updated/Rectum/Results/Relative Abundance Rectum3.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSERectum <- LEFSERectum %>% slice(1:nrow)
LEFSERectum <-cbind(LEFSERectum, RelativeAbundance)
LEFSERectum <- na.omit(LEFSERectum)
LEFSERectum$Class = ifelse(LEFSERectum$CONTROL < LEFSERectum$GOS,"GOS","CONTROL")
LEFSERectum$pValue <- round(LEFSERectum$pValue, digits = 3)
LEFSERectum$significance <- ifelse(LEFSERectum$pValue < "0.001", "****",
                      		ifelse(LEFSERectum$pValue < "0.01", "***",
                      		ifelse(LEFSERectum$pValue < "0.025", "**",
                      		ifelse(LEFSERectum$pValue <= "0.05", "*"))))
LEFSERectum$Names = paste(LEFSERectum$OTU, LEFSERectum$Genus, LEFSERectum$significance)
LEFSERectum <- LEFSERectum %>% slice(1:10)
LEFSERectum$Names [4] <- "Otu020 Ruminococcaceae UC *"
LEFSERectum$Names [5] <- "Otu024 Peptostreptococcaceae UC *"
LEFSERectum$Names [6] <- "Otu030 Ruminococcaceae UC *"
LEFSERectum$Names [7] <- "Otu039 Clostridium XIVb **"
LEFSERectum$Names [10] <- "Otu050 Firmicutes UC *"
LEFSERectum <- arrange(LEFSERectum, desc(LDA))
LEFSERectum <- arrange(LEFSERectum, desc(Class))

LEFSETrial3 <- rbind(LEFSEDuodenum, LEFSEJejunum, LEFSEIleum, LEFSECaecum, LEFSEColon, LEFSERectum)
LEFSETrial3Graph <- select(LEFSETrial3, Names, LDA, Class)
my_palette3 <- c("#7570B3", "#E7298A")

par(mar = c(4, 16, 4, 0.5))
barplot(LEFSETrial3Graph$LDA,
         horiz = TRUE,
         col = my_palette3[as.factor(LEFSETrial3Graph$Class)],
         xlim = c(0, 5),
         xlab ="LDA Score log 10",
         font.lab = 2,
         font = 2,
         names.arg = LEFSETrial3Graph$Names,
	 las = 1,
         cex.names = 0.8,
         cex.lab = 1.0)
abline(h=0.1, lwd = 2)
abline(h=6.1, lwd = 2)
abline(h=18.1, lwd = 2)
abline(h=27.7, lwd = 2)
abline(h=39.7, lwd = 2)
abline(h=51.65, lwd = 2)
abline(h=63.51, lwd = 2)
legend(x = 0, y = 66.5, c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1.2, h = TRUE, pch = 15, text.font = 2, col = c("#7570B3", "#E7298A"))
mtext("Trial 3", side=3, adj=-0.25, line=0, cex=1.2, font=2, font.lab = 2)
text(x = 4.5, y = 4, label ="Duodenum", cex = 1, font = 2)
text(x = 4.5, y = 16, label ="Jejunum", cex = 1, font = 2)
text(x = 4.5, y = 25, label ="Ileum", cex = 1, font = 2)
text(x = 4.5, y = 37, label ="Caecum", cex = 1, font = 2)
text(x = 4.5, y = 49, label ="Colon", cex = 1, font = 2)
text(x = 4.5, y = 61.25, label ="Rectum", cex = 1, font = 2)
text(3, 64.8, label = substitute(paste(italic("*P"), " = 0.05")), font = 2, col = "black")
text(3.75, 64.8, label = substitute(paste(italic("**P"), " = 0.025")), font = 2, col = "black")
text(4.5, 64.8, label = substitute(paste(italic("***P"), " = 0.01")), font = 2, col = "black")
dev.off()

#SUPPLEMENTARY FIGURE 4D

set.seed(3711)
library(dplyr)
library(openxlsx)
options(scipen=1000)
tiff('F:/RFigure/LEFSETrial4.tiff', pointsize=10, width=2600, height=2600, res=300)
LEFSEDuodenum = read.table("D:/HAUPT4_Updated/Duodenum/stability.opti_mcc.0.03.subsample.0.0319.lefse_summary", header=TRUE, sep="\t")
LEFSEDuodenum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT4_Updated/Duodenum/Results/Relative Abundance Duodenum4.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEDuodenum <- LEFSEDuodenum %>% slice(1:nrow)
LEFSEDuodenum <-cbind(LEFSEDuodenum, RelativeAbundance)
LEFSEDuodenum <- na.omit(LEFSEDuodenum)
LEFSEDuodenum$Class = ifelse(LEFSEDuodenum$CONTROL < LEFSEDuodenum$GOS,"GOS","CONTROL")
LEFSEDuodenum$pValue <- round(LEFSEDuodenum$pValue, digits = 3)
LEFSEDuodenum$significance <- ifelse(LEFSEDuodenum$pValue < "0.001", "****",
                      		ifelse(LEFSEDuodenum$pValue < "0.01", "***",
                      		ifelse(LEFSEDuodenum$pValue < "0.025", "**",
                      		ifelse(LEFSEDuodenum$pValue <= "0.05", "*"))))
LEFSEDuodenum$Names = paste(LEFSEDuodenum$OTU, LEFSEDuodenum$Genus, LEFSEDuodenum$significance)
LEFSEDuodenum <- LEFSEDuodenum %>% slice(1:10)
LEFSEDuodenum$Names [4] <- "Otu022 Veillonellaceae UC *"
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(LDA))
LEFSEDuodenum <- arrange(LEFSEDuodenum, desc(Class))

LEFSEJejunum = read.table("D:/HAUPT4_Updated/Jejunum/stability.opti_mcc.0.03.subsample.0.0320.lefse_summary", header=TRUE, sep="\t")
LEFSEJejunum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT4_Updated/Jejunum/Results/Relative Abundance Jejunum4.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEJejunum <- LEFSEJejunum %>% slice(1:nrow)
LEFSEJejunum <-cbind(LEFSEJejunum, RelativeAbundance)
LEFSEJejunum <- na.omit(LEFSEJejunum)
LEFSEJejunum$Class = ifelse(LEFSEJejunum$CONTROL < LEFSEJejunum$GOS,"GOS","CONTROL")
LEFSEJejunum$pValue <- round(LEFSEJejunum$pValue, digits = 3)
LEFSEJejunum$significance <- ifelse(LEFSEJejunum$pValue < "0.001", "****",
                      		ifelse(LEFSEJejunum$pValue < "0.01", "***",
                      		ifelse(LEFSEJejunum$pValue < "0.025", "**",
                      		ifelse(LEFSEJejunum$pValue <= "0.05", "*"))))
LEFSEJejunum$Names = paste(LEFSEJejunum$OTU, LEFSEJejunum$Genus, LEFSEJejunum$significance)
LEFSEJejunum <- LEFSEJejunum %>% slice(1:10)
LEFSEJejunum$Names [1] <- "Otu021 Pasteurellaceae UC *"
LEFSEJejunum <- arrange(LEFSEJejunum, desc(LDA))
LEFSEJejunum <- arrange(LEFSEJejunum, desc(Class))

LEFSEIleum = read.table("D:/HAUPT4_Updated/Ileum/stability.opti_mcc.0.03.subsample.0.0321.lefse_summary", header=TRUE, sep="\t")
LEFSEIleum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT4_Updated/Ileum/Results/Relative Abundance Ileum4.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEIleum <- LEFSEIleum %>% slice(1:nrow)
LEFSEIleum <-cbind(LEFSEIleum, RelativeAbundance)
LEFSEIleum <- na.omit(LEFSEIleum)
LEFSEIleum$Class = ifelse(LEFSEIleum$CONTROL < LEFSEIleum$GOS,"GOS","CONTROL")
LEFSEIleum$pValue <- round(LEFSEIleum$pValue, digits = 3)
LEFSEIleum$significance <- ifelse(LEFSEIleum$pValue < "0.001", "****",
                      		ifelse(LEFSEIleum$pValue < "0.01", "***",
                      		ifelse(LEFSEIleum$pValue < "0.025", "**",
                      		ifelse(LEFSEIleum$pValue <= "0.05", "*"))))
LEFSEIleum$Names = paste(LEFSEIleum$OTU, LEFSEIleum$Genus, LEFSEIleum$significance)
LEFSEIleum <- LEFSEIleum %>% slice(1:10)
LEFSEIleum <- arrange(LEFSEIleum, desc(LDA))
LEFSEIleum <- arrange(LEFSEIleum, desc(Class))

LEFSECaecum = read.table("D:/HAUPT4_Updated/Caecum/stability.opti_mcc.0.03.subsample.0.0322.lefse_summary", header=TRUE, sep="\t")
LEFSECaecum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT4_Updated/Caecum/Results/Relative Abundance Caecum4.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSECaecum <- LEFSECaecum %>% slice(1:nrow)
LEFSECaecum <-cbind(LEFSECaecum, RelativeAbundance)
LEFSECaecum <- na.omit(LEFSECaecum)
LEFSECaecum$Class = ifelse(LEFSECaecum$CONTROL < LEFSECaecum$GOS,"GOS","CONTROL")
LEFSECaecum$pValue <- round(LEFSECaecum$pValue, digits = 3)
LEFSECaecum$significance <- ifelse(LEFSECaecum$pValue < "0.001", "****",
                      		ifelse(LEFSECaecum$pValue < "0.01", "***",
                      		ifelse(LEFSECaecum$pValue < "0.025", "**",
                      		ifelse(LEFSECaecum$pValue <= "0.05", "*"))))
LEFSECaecum$Names = paste(LEFSECaecum$OTU, LEFSECaecum$Genus, LEFSECaecum$significance)
LEFSECaecum <- LEFSECaecum %>% slice(1:10)
LEFSECaecum$Names [1] <- "Otu001 Enterobacteriaceae UC *"
LEFSECaecum$Names [7] <- "Otu009 Veillonellaceae UC **"
LEFSECaecum <- arrange(LEFSECaecum, desc(LDA))
LEFSECaecum <- arrange(LEFSECaecum, desc(Class))

LEFSEColon = read.table("D:/HAUPT4_Updated/Colon/stability.opti_mcc.0.03.subsample.0.0323.lefse_summary", header=TRUE, sep="\t")
LEFSEColon$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT4_Updated/Colon/Results/Relative Abundance Colon4.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSEColon <- LEFSEColon %>% slice(1:nrow)
LEFSEColon <-cbind(LEFSEColon, RelativeAbundance)
LEFSEColon <- na.omit(LEFSEColon)
LEFSEColon$Class = ifelse(LEFSEColon$CONTROL < LEFSEColon$GOS,"GOS","CONTROL")
LEFSEColon$pValue <- round(LEFSEColon$pValue, digits = 3)
LEFSEColon$significance <- ifelse(LEFSEColon$pValue < "0.001", "****",
                      		ifelse(LEFSEColon$pValue < "0.01", "***",
                      		ifelse(LEFSEColon$pValue < "0.025", "**",
                      		ifelse(LEFSEColon$pValue <= "0.05", "*"))))
LEFSEColon$Names = paste(LEFSEColon$OTU, LEFSEColon$Genus, LEFSEColon$significance)
LEFSEColon <- LEFSEColon %>% slice(1:10)
LEFSEColon$Names [7] <- "Otu022 Clostridium XIVa *"
LEFSEColon$Names [8] <- "Otu030 Erysipelotrichaceae UC ***"
LEFSEColon <- arrange(LEFSEColon, desc(LDA))
LEFSEColon <- arrange(LEFSEColon, desc(Class))

LEFSERectum = read.table("D:/HAUPT4_Updated/Rectum/stability.opti_mcc.0.0324.subsample.0.03.lefse_summary", header=TRUE, sep="\t")
LEFSERectum$logMaxMean <- NULL
RelativeAbundance = read.table("D:/HAUPT4_Updated/Rectum/Results/Relative Abundance Rectum4.txt", header=TRUE, sep="\t")
RelativeAbundance = RelativeAbundance <- select(RelativeAbundance, Genus, CONTROL, GOS,TOTAL)
RelativeAbundance <- RelativeAbundance[RelativeAbundance$TOTAL > 0.01, ]
nrow <- nrow(RelativeAbundance)
LEFSERectum <- LEFSERectum %>% slice(1:nrow)
LEFSERectum <-cbind(LEFSERectum, RelativeAbundance)
LEFSERectum <- na.omit(LEFSERectum)
LEFSERectum$Class = ifelse(LEFSERectum$CONTROL < LEFSERectum$GOS,"GOS","CONTROL")
LEFSERectum$pValue <- round(LEFSERectum$pValue, digits = 3)
LEFSERectum$significance <- ifelse(LEFSERectum$pValue < "0.001", "****",
                      		ifelse(LEFSERectum$pValue < "0.01", "***",
                      		ifelse(LEFSERectum$pValue < "0.025", "**",
                      		ifelse(LEFSERectum$pValue <= "0.05", "*"))))
LEFSERectum$Names = paste(LEFSERectum$OTU, LEFSERectum$Genus, LEFSERectum$significance)
LEFSERectum <- LEFSERectum %>% slice(1:10)
LEFSERectum$Names [6] <- "Otu031 Clostridium XIVa *"
LEFSERectum$Names [8] <- "Otu033 Erysipelotrichaceae UC **"
LEFSERectum <- arrange(LEFSERectum, desc(LDA))
LEFSERectum <- arrange(LEFSERectum, desc(Class))

LEFSETrial4 <- rbind(LEFSEDuodenum, LEFSEJejunum, LEFSEIleum, LEFSECaecum, LEFSEColon, LEFSERectum)
LEFSETrial4Graph <- select(LEFSETrial4, Names, LDA, Class)
my_palette3 <- c("#7570B3", "#E7298A")

par(mar = c(4, 16, 4, 0.5))
barplot(LEFSETrial4Graph$LDA,
         horiz = TRUE,
         col = my_palette3[as.factor(LEFSETrial4Graph$Class)],
         xlim = c(0, 5),
         xlab ="LDA Score log 10",
         font.lab = 2,
         font = 2,
         names.arg = LEFSETrial4Graph$Names,
	 las = 1,
         cex.names = 0.8,
         cex.lab = 1.0)
abline(h=0.1, lwd = 2)
abline(h=12.1, lwd = 2)
abline(h=24.1, lwd = 2)
abline(h=36, lwd = 2)
abline(h=48.1, lwd = 2)
abline(h=60.1, lwd = 2)
abline(h=71.95, lwd = 2)
legend(x = 0, y = 75.25, c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1.2, h = TRUE, pch = 15, text.font = 2, col = c("#7570B3", "#E7298A"))
mtext("Trial 4", side=3, adj=-0.25, line=0, cex=1.2, font=2, font.lab = 2)
text(x = 4.7, y = 7.4, label ="Duodenum", cex = 1, font = 2)
text(x = 4.7, y = 22, label ="Jejunum", cex = 1, font = 2)
text(x = 4.7, y = 34, label ="Ileum", cex = 1, font = 2)
text(x = 4.7, y = 45.7, label ="Caecum", cex = 1, font = 2)
text(x = 4.7, y = 57.4, label ="Colon", cex = 1, font = 2)
text(x = 4.7, y = 69.3, label ="Rectum", cex = 1, font = 2)
text(3, 73, label = substitute(paste(italic("*P"), " = 0.05")), font = 2, col = "black")
text(3.75, 73, label = substitute(paste(italic("**P"), " = 0.025")), font = 2, col = "black")
text(4.5, 73, label = substitute(paste(italic("***P"), " = 0.01")), font = 2, col = "black")
dev.off()

#SUPPLEMENTARY FIGURE 5

JejunumVCR2 = read.table("D:/JejunumVCR2.txt", header=TRUE, sep="\t")
IleumVCR2 = read.table("D:/IleumVCR2.txt", header=TRUE, sep="\t")
ColonGC2 = read.table("D:/ColonGC2.txt", header=TRUE, sep="\t")
CecumGC2 = read.table("D:/CecumGC2.txt", header=TRUE, sep="\t")
tiff('D:/Supplementary1A.tiff', pointsize=10, width=2400, height=2400, res=300)
par(mfrow = c(3,2))
par(mar = c(4, 5, 4, 4))
plot(JejunumVCR2$VHC, JejunumVCR2$VAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = expression(bold(paste("Height ", mu, "m"))),
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 900),
      ylim = c(0, 100000))
points(JejunumVCR2$VHG, JejunumVCR2$VAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(JejunumVCR2$VAC ~ JejunumVCR2$VHC), col = "#7570B3", lwd = 2)
abline(lm(JejunumVCR2$VAG ~ JejunumVCR2$VHG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 800, y = 40000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 800, y = 32000, label = substitute(paste(italic("R"^2), " = 0.59    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 800, y = 20000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 800, y = 12000, label = substitute(paste(italic("R"^2), " = 0.58    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Jejunal Villus", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(JejunumVCR2$CDC, JejunumVCR2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = expression(bold(paste("Depth ", mu, "m"))),
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 500),
      ylim = c(0, 30000))
points(JejunumVCR2$CDG, JejunumVCR2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(JejunumVCR2$CAC ~ JejunumVCR2$CDC), col = "#7570B3", lwd = 2)
abline(lm(JejunumVCR2$CAG ~ JejunumVCR2$CDG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 450, y = 8000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 450, y = 6000, label = substitute(paste(italic("R"^2), " = 0.56    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 450, y = 4000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 450, y = 2000, label = substitute(paste(italic("R"^2), " = 0.68    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Jejunal Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(IleumVCR2$VHC, IleumVCR2$VAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = expression(bold(paste("Height ", mu, "m"))),
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 700),
      ylim = c(0, 100000))
points(IleumVCR2$VHG, IleumVCR2$VAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(IleumVCR2$VAC ~ IleumVCR2$VHC), col = "#7570B3", lwd = 2)
abline(lm(IleumVCR2$VAG ~ IleumVCR2$VHG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 600, y = 40000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 600, y = 32000, label = substitute(paste(italic("R"^2), " = 0.56    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 600, y = 20000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 600, y = 12000, label = substitute(paste(italic("R"^2), " = 0.57    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Ileal Villus", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(IleumVCR2$CDC, IleumVCR2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = expression(bold(paste("Depth ", mu, "m"))),
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 500),
      ylim = c(0, 30000))
points(IleumVCR2$CDG, IleumVCR2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(IleumVCR2$CAC ~ IleumVCR2$CDC), col = "#7570B3", lwd = 2)
abline(lm(IleumVCR2$CAG ~ IleumVCR2$CDG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 450, y = 8000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 450, y = 6000, label = substitute(paste(italic("R"^2), " = 0.72    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 450, y = 4000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 450, y = 2000, label = substitute(paste(italic("R"^2), " = 0.72    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Ileal Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(ColonGC2$CDC, ColonGC2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = expression(bold(paste("Depth ", mu, "m"))),
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 700),
      ylim = c(0, 50000))
points(ColonGC2$CDG, ColonGC2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(ColonGC2$CAC ~ ColonGC2$CDC), col = "#7570B3", lwd = 2)
abline(lm(ColonGC2$CAG ~ ColonGC2$CDG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 600, y = 15000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 600, y = 13000, label = substitute(paste(italic("R"^2), " = 0.65    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 600, y = 9000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 600, y = 7000, label = substitute(paste(italic("R"^2), " = 0.70    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Colonic Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(CecumGC2$CDC, CecumGC2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = expression(bold(paste("Depth ", mu, "m"))),
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 600),
      ylim = c(0, 50000))
points(CecumGC2$CDG, CecumGC2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(CecumGC2$CAC ~ CecumGC2$CDC), col = "#7570B3", lwd = 2)
abline(lm(CecumGC2$CAG ~ CecumGC2$CDG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 550, y = 20000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 550, y = 18000, label = substitute(paste(italic("R"^2), " = 0.52    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 550, y = 14000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 550, y = 12000, label = substitute(paste(italic("R"^2), " = 0.60    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Caecal Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)
dev.off()

#SUPPLEMENTARY FIGURE 6

options( scipen = 999 )
tiff('D:/Supplementary3b.tiff', pointsize=10, width=2400, height=2400, res=300)
par(mfrow = c(3,2))
JejunumGC2=read.table("D:/JejunumGC2.txt", header=TRUE, sep="\t")
par(mar = c(4, 5, 4, 4))
plot(JejunumGC2$GCVC, JejunumGC2$VAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = "Number of Goblet Cells",
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 50),
      ylim = c(0, 120000))
      points(JejunumGC2$GCVG, JejunumGC2$VAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(JejunumGC2$VAC ~ JejunumGC2$GCVC), col = "#7570B3", lwd = 2)
abline(lm(JejunumGC2$VAG ~ JejunumGC2$GCVG), col = "#E7298A", lwd = 2)
legend("topleft", c("Non-GOS Piglets", "GOS Piglets"), bty = "n", cex = 1, pch = 19, text.font = 2, col = c("#7570B3","#E7298A"))
text(x = 40, y = 40000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 39, y = 32000, label = substitute(paste(italic("R"^2), " = 0.18")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 40, y = 20000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 39, y = 12000, label = substitute(paste(italic("R"^2), " = 0.32")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Jejunal Villus", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(JejunumGC2$GCCC, JejunumGC2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = "Number of Goblet Cells",
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 55),
      ylim = c(0, 35000))
      points(JejunumGC2$GCCG, JejunumGC2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(JejunumGC2$CAC ~ JejunumGC2$GCCC), col = "#7570B3", lwd = 2)
abline(lm(JejunumGC2$CAG ~ JejunumGC2$GCCG), col = "#E7298A", lwd = 2)
text(x = 49, y = 10000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 49, y = 8000, label = substitute(paste(italic("R"^2), " = 0.37    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 49, y = 5000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 49, y = 3000, label = substitute(paste(italic("R"^2), " = 0.24    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Jejunal Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

IlleumGC2=read.table("D:/IlleumGC2.txt", header=TRUE, sep="\t")
par(mar = c(4, 5, 4, 4))
plot(IlleumGC2$GCVC, IlleumGC2$VAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = "Number of Goblet Cells",
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 60),
      ylim = c(0, 80000))
      points(IlleumGC2$GCVG, IlleumGC2$VAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(IlleumGC2$VAC ~ IlleumGC2$GCVC), col = "#7570B3", lwd = 2)
abline(lm(IlleumGC2$VAG ~ IlleumGC2$GCVG), col = "#E7298A", lwd = 2)
text(x = 49, y = 15000, label = substitute(paste(italic("P"), " = < 0.027")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 49, y = 12000, label = substitute(paste(italic("R"^2), " = 0.27    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 49, y = 6000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 49, y = 3000, label = substitute(paste(italic("R"^2), " = 0.38    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Ileal Villus", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)

par(mar = c(4, 5, 4, 4))
plot(IlleumGC2$GCCC, IlleumGC2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = "Number of Goblet Cells",
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 85),
      ylim = c(0,45000))
      points(IlleumGC2$GCCG, IlleumGC2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(IlleumGC2$CAC ~ IlleumGC2$GCCC), col = "#7570B3", lwd = 2)
abline(lm(IlleumGC2$CAG ~ IlleumGC2$GCCG), col = "#E7298A", lwd = 2)
text(x = 70, y = 15000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 70, y = 12000, label = substitute(paste(italic("R"^2), " = 0.31    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 70, y = 6000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 70, y = 3000, label = substitute(paste(italic("R"^2), " = 0.49    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Ileal Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)


ColonGC2=read.table("D:/ColonGC2.txt", header=TRUE, sep="\t")
par(mar = c(4, 5, 4, 4))
plot(ColonGC2$GCCC, ColonGC2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = "Number of Goblet Cells",
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 120),
      ylim = c(0, 50000))
      points(ColonGC2$GCCG, ColonGC2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(ColonGC2$CAC ~ ColonGC2$GCCC), col = "#7570B3", lwd = 2)
abline(lm(ColonGC2$CAG ~ ColonGC2$GCCG), col = "#E7298A", lwd = 2)
text(x = 100, y = 15000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 100, y = 12000, label = substitute(paste(italic("R"^2), " = 0.26    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 100, y = 6000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 100, y = 3000, label = substitute(paste(italic("R"^2), " = 0.35    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Colonic Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)


CecumGC2=read.table("D:/CecumGC2.txt", header=TRUE, sep="\t")
par(mar = c(4, 5, 4, 4))
plot(CecumGC2$GCCC, CecumGC2$CAC,
      pch = 20,
      cex = 1,
      cex.lab = 1,
      cex.axis =1,
      font.lab =2,
      font =2,
      col = "#7570B3",
      xlab = "Number of Goblet Cells",
      ylab = expression(bold(paste("Area ", mu, "m"^2))),
      xlim = c(0, 120),
      ylim = c(0, 50000))
      points(CecumGC2$GCCG, CecumGC2$CAG,
      pch = 20,
      cex = 1,
      col = "#E7298A")
abline(lm(CecumGC2$CAC ~ CecumGC2$GCCC), col = "#7570B3", lwd = 2)
abline(lm(CecumGC2$CAG ~ CecumGC2$GCCG), col = "#E7298A", lwd = 2)
text(x = 100, y = 15000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 100, y = 12000, label = substitute(paste(italic("R"^2), " = 0.43    ")), font = 2, cex = 0.8, col = "#7570B3")
text(x = 100, y = 6000, label = substitute(paste(italic("P"), " = < 0.001")), font = 2, cex = 0.8, col = "#E7298A")
text(x = 100, y = 3000, label = substitute(paste(italic("R"^2), " = 0.50    ")), font = 2, cex = 0.8, col = "#E7298A")
mtext("Caecal Crypt", side=3, adj=0.5, line=0.8, cex=1.0, font=2, font.lab = 2)
dev.off()